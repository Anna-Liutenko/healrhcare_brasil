# üîí –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: –°—Ç—Ä–∞–Ω–∏—Ü–∞-–∫–æ–ª–ª–µ–∫—Ü–∏—è

**–î–∞—Ç–∞:** 19 –æ–∫—Ç—è–±—Ä—è 2025  
**–ê—É–¥–∏—Ç–æ—Ä:** GitHub Copilot  
**–ó–∞–¥–∞—á–∞:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –º–∞–ª—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

---

## üìä –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- üåê –¢—Ä–∞—Ñ—Ñ–∏–∫: 1,000 - 10,000 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥–µ–Ω—å
- üí∞ –ë—é–¥–∂–µ—Ç: –ù–∏–∑–∫–∏–π (–±–µ–∑ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
- üë• CMS –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–≤ + –ø—É–±–ª–∏—á–Ω—ã–π —Å–∞–π—Ç
- üéØ –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è: –†—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ —ç–∫—Å–ø–∞—Ç—ã –≤ –ë—Ä–∞–∑–∏–ª–∏–∏

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (health-related content)
- ‚ö†Ô∏è –†–µ–ø—É—Ç–∞—Ü–∏—è (–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
- ‚ö†Ô∏è SEO (—Å—Ç—Ä–∞–Ω–∏—Ü–∞-–∫–æ–ª–ª–µ–∫—Ü–∏—è ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Ç—Ä–∞—Ñ–∏–∫–∞)

---

## üéØ OWASP Top 10 2021 ‚Äî –ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –∫ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º

### ‚úÖ A01:2021 ‚Äî Broken Access Control

**–†–∏—Å–∫:** –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ `collectionConfig`, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç–∏–Ω–æ–∫ –∫–∞—Ä—Ç–æ—á–µ–∫

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ø–ª–∞–Ω–µ:**
- ‚ùå **–û–¢–°–£–¢–°–¢–í–£–ï–¢:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è `PATCH /api/pages/:id/card-image`
- ‚ùå **–û–¢–°–£–¢–°–¢–í–£–ï–¢:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (admin/editor)
- ‚ùå **–û–¢–°–£–¢–°–¢–í–£–ï–¢:** –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∞–≤ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```php
// backend/src/Presentation/Controller/CollectionController.php

public function updateCardImage(string $pageId): void
{
    // ‚úÖ 1. –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø
    $sessionRepo = new MySQLSessionRepository();
    $token = $_SERVER['HTTP_AUTHORIZATION'] ?? '';
    
    if (!$sessionRepo->isValid($token)) {
        http_response_code(401);
        echo json_encode(['error' => 'Unauthorized']);
        exit;
    }
    
    $session = $sessionRepo->findByToken($token);
    $userId = $session['user_id'];
    
    // ‚úÖ 2. –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏)
    $userRepo = new MySQLUserRepository();
    $user = $userRepo->findById($userId);
    
    if (!in_array($user->getRole()->value, ['super_admin', 'admin', 'editor'])) {
        http_response_code(403);
        echo json_encode(['error' => 'Forbidden']);
        exit;
    }
    
    // ‚úÖ 3. –í–ê–õ–ò–î–ê–¶–ò–Ø –í–õ–ê–î–ï–ù–ò–Ø (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É
    
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
}
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üî¥ HIGH  
**–£—Å–∏–ª–∏—è:** ~30 –º–∏–Ω—É—Ç

---

### ‚úÖ A02:2021 ‚Äî Cryptographic Failures

**–†–∏—Å–∫:** –£—Ç–µ—á–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Å–µ—Å—Å–∏–∏, –ø–∞—Ä–æ–ª–∏)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `password_hash()` —Å bcrypt (cost=10)
- ‚úÖ –°–µ—Å—Å–∏–∏ —Å expires_at
- ‚ö†Ô∏è **–£–Ø–ó–í–ò–ú–û–°–¢–¨:** –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ HTTPS –¥–ª—è production

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```php
// backend/public/index.php (–¥–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ)

// ‚úÖ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π HTTPS –¥–ª—è production
if ($_SERVER['HTTP_HOST'] !== 'localhost' && 
    empty($_SERVER['HTTPS']) || $_SERVER['HTTPS'] === 'off') {
    header('Location: https://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI']);
    exit;
}

// ‚úÖ Security headers
header('Strict-Transport-Security: max-age=31536000; includeSubDomains');
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° MEDIUM  
**–£—Å–∏–ª–∏—è:** ~10 –º–∏–Ω—É—Ç

---

### ‚úÖ A03:2021 ‚Äî Injection (–≤–∫–ª—é—á–∞—è XSS)

**–†–∏—Å–∫:** XSS —á–µ—Ä–µ–∑ `collectionConfig.cardImages`, SQL injection

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ø–ª–∞–Ω–µ:**

#### SQL Injection:
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PDO::prepare –≤ `MySQLPageRepository`
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

#### XSS Protection:
- ‚ö†Ô∏è **–£–Ø–ó–í–ò–ú–û–°–¢–¨ –≤ –ø–ª–∞–Ω–µ:** –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–¥ –∏–∑ –ø–ª–∞–Ω–∞:**

```php
// ‚ùå –£–Ø–ó–í–ò–ú–û–°–¢–¨: –ü—Ä—è–º–∞—è –≤—Å—Ç–∞–≤–∫–∞ URL –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
foreach ($collectionData['sections'] as $section) {
    foreach ($section['items'] as $item) {
        $html .= '<div class="article-card">
            <img src="' . htmlspecialchars($item['image']) . '">  // ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ!
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
1. `htmlspecialchars()` –Ω–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç JavaScript –≤ `src` –∞—Ç—Ä–∏–±—É—Ç–µ
2. –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ URL —Å—Ö–µ–º—ã (–º–æ–∂–µ—Ç –±—ã—Ç—å `javascript:alert(1)`)

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```php
// backend/src/Application/UseCase/UpdateCollectionCardImage.php

public function execute(string $collectionPageId, string $targetPageId, string $imageUrl): void
{
    // ‚úÖ 1. –í–ê–õ–ò–î–ê–¶–ò–Ø URL
    if (!$this->isValidImageUrl($imageUrl)) {
        throw new \InvalidArgumentException('Invalid image URL');
    }
    
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
}

private function isValidImageUrl(string $url): bool
{
    // ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–µ–º—ã (—Ç–æ–ª—å–∫–æ /uploads/ –∏–ª–∏ https://)
    if (!preg_match('~^(/uploads/|https://)~i', $url)) {
        return false;
    }
    
    // ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–∞
    $ext = strtolower(pathinfo(parse_url($url, PHP_URL_PATH), PATHINFO_EXTENSION));
    if (!in_array($ext, ['jpg', 'jpeg', 'png', 'gif', 'webp', 'svg'])) {
        return false;
    }
    
    // ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –æ–ø–∞—Å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
    if (preg_match('/[<>"\'\(\)]/', $url)) {
        return false;
    }
    
    // ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö)
    if (str_starts_with($url, '/uploads/')) {
        $filePath = __DIR__ . '/../../../public' . $url;
        if (!file_exists($filePath)) {
            return false;
        }
    }
    
    return true;
}
```

**–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ —Å CSP-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º –∫–æ–¥–æ–º:**

```php
// backend/src/Presentation/Controller/PublicPageController.php

private function renderCollectionPage(array $page): void
{
    // ... –∫–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö ...
    
    foreach ($collectionData['sections'] as $section) {
        foreach ($section['items'] as $item) {
            // ‚úÖ –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –í–°–ï–• –∞—Ç—Ä–∏–±—É—Ç–æ–≤
            $imageUrl = $this->sanitizeImageUrl($item['image']);
            $title = htmlspecialchars($item['title'], ENT_QUOTES, 'UTF-8');
            $snippet = htmlspecialchars($item['snippet'], ENT_QUOTES, 'UTF-8');
            $url = htmlspecialchars($item['url'], ENT_QUOTES, 'UTF-8');
            
            $html .= '<div class="article-card">
                <img src="' . $imageUrl . '" alt="' . $title . '">
                <div class="article-card-content">
                    <h3>' . $title . '</h3>
                    <p>' . $snippet . '</p>
                    <a href="' . $url . '">–ß–∏—Ç–∞—Ç—å –¥–∞–ª–µ–µ &rarr;</a>
                </div>
            </div>';
        }
    }
    
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
}

private function sanitizeImageUrl(string $url): string
{
    // ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –¥–ª—è src –∞—Ç—Ä–∏–±—É—Ç–∞
    $url = filter_var($url, FILTER_SANITIZE_URL);
    
    // ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ JavaScript —Å—Ö–µ–º
    if (preg_match('/^(javascript|data):/i', $url)) {
        return '/uploads/default-card.jpg'; // fallback
    }
    
    return htmlspecialchars($url, ENT_QUOTES, 'UTF-8');
}
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üî¥ HIGH  
**–£—Å–∏–ª–∏—è:** ~1 —á–∞—Å

---

### ‚úÖ A04:2021 ‚Äî Insecure Design

**–†–∏—Å–∫:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting, DoS —á–µ—Ä–µ–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚ùå **–û–¢–°–£–¢–°–¢–í–£–ï–¢:** Rate limiting –¥–ª—è API endpoints
- ‚ùå **–û–¢–°–£–¢–°–¢–í–£–ï–¢:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ `collectionConfig`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```php
// backend/src/Application/UseCase/GetCollectionItems.php

public function execute(string $collectionPageId): array
{
    // ... –∫–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏ config ...
    
    // ‚úÖ –ó–ê–©–ò–¢–ê –û–¢ DoS: –õ–∏–º–∏—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
    $maxItems = 500; // –ú–∞–∫—Å–∏–º—É–º 500 —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
    
    if (isset($config['limit']) && $config['limit'] > $maxItems) {
        throw new \InvalidArgumentException('Collection limit exceeds maximum: ' . $maxItems);
    }
    
    // ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ª–∏–º–∏—Ç –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω
    if (!isset($config['limit']) || $config['limit'] === null) {
        $config['limit'] = $maxItems;
    }
    
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
}
```

**Rate Limiting (–ø—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –º–∞–ª–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞):**

```php
// backend/src/Infrastructure/Middleware/RateLimiter.php

class RateLimiter
{
    private const MAX_REQUESTS = 60; // requests per minute
    private const WINDOW = 60; // seconds
    
    public static function check(string $endpoint, string $ip): bool
    {
        $cacheDir = __DIR__ . '/../../../cache/rate-limit/';
        if (!is_dir($cacheDir)) {
            mkdir($cacheDir, 0755, true);
        }
        
        $key = md5($endpoint . $ip);
        $file = $cacheDir . $key . '.txt';
        
        $now = time();
        $requests = [];
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤
        if (file_exists($file)) {
            $requests = json_decode(file_get_contents($file), true) ?: [];
        }
        
        // –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã
        $requests = array_filter($requests, fn($ts) => $now - $ts < self::WINDOW);
        
        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç
        if (count($requests) >= self::MAX_REQUESTS) {
            return false; // Rate limit exceeded
        }
        
        // –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π –∑–∞–ø—Ä–æ—Å
        $requests[] = $now;
        file_put_contents($file, json_encode($requests));
        
        return true;
    }
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```php
// backend/src/Presentation/Controller/CollectionController.php

public function getItems(string $pageId): void
{
    // ‚úÖ Rate limiting
    $ip = $_SERVER['REMOTE_ADDR'] ?? 'unknown';
    
    if (!RateLimiter::check('/api/pages/collection-items', $ip)) {
        http_response_code(429);
        echo json_encode(['error' => 'Too Many Requests']);
        exit;
    }
    
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
}
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° MEDIUM  
**–£—Å–∏–ª–∏—è:** ~1 —á–∞—Å

---

### ‚úÖ A05:2021 ‚Äî Security Misconfiguration

**–†–∏—Å–∫:** –û—Ç–∫—Ä—ã—Ç—ã–µ debug endpoints, verbose errors

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚ö†Ô∏è **–£–Ø–ó–í–ò–ú–û–°–¢–¨:** –í –ø–ª–∞–Ω–µ –µ—Å—Ç—å `e2eLog()` ‚Äî –º–æ–∂–µ—Ç —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```php
// backend/config/config.php

return [
    'debug' => $_ENV['APP_ENV'] !== 'production', // ‚úÖ –û—Ç–∫–ª—é—á–∏—Ç—å debug –≤ production
    'log_level' => $_ENV['APP_ENV'] === 'production' ? 'error' : 'debug',
    'display_errors' => $_ENV['APP_ENV'] !== 'production',
];
```

```php
// backend/public/index.php

// ‚úÖ –û—Ç–∫–ª—é—á–∏—Ç—å –≤—ã–≤–æ–¥ –æ—à–∏–±–æ–∫ –≤ production
if ($_ENV['APP_ENV'] === 'production') {
    ini_set('display_errors', '0');
    error_reporting(E_ALL & ~E_DEPRECATED & ~E_STRICT);
} else {
    ini_set('display_errors', '1');
    error_reporting(E_ALL);
}
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° MEDIUM  
**–£—Å–∏–ª–∏—è:** ~15 –º–∏–Ω—É—Ç

---

### ‚úÖ A07:2021 ‚Äî Identification and Authentication Failures

**–†–∏—Å–∫:** –°–ª–∞–±—ã–µ —Å–µ—Å—Å–∏–∏, –±—Ä—É—Ç—Ñ–æ—Ä—Å

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è session expiration
- ‚ùå **–û–¢–°–£–¢–°–¢–í–£–ï–¢:** –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```php
// backend/src/Application/UseCase/Login.php

public function execute(string $username, string $password): array
{
    // ‚úÖ –ó–ê–©–ò–¢–ê –û–¢ –ë–†–£–¢–§–û–†–°–ê: –ó–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–π –ø–æ–ø—ã—Ç–∫–µ
    $ip = $_SERVER['REMOTE_ADDR'] ?? 'unknown';
    $lockoutFile = __DIR__ . '/../../../cache/login-attempts/' . md5($ip) . '.txt';
    
    if (file_exists($lockoutFile)) {
        $attempts = json_decode(file_get_contents($lockoutFile), true);
        $failedCount = count(array_filter($attempts, fn($a) => !$a['success']));
        
        if ($failedCount >= 5) {
            // ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 15 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ 5 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
            $lastAttempt = end($attempts)['timestamp'];
            if (time() - $lastAttempt < 900) { // 15 minutes
                throw new \Exception('Too many failed login attempts. Try again later.');
            }
        }
    }
    
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
}
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° MEDIUM  
**–£—Å–∏–ª–∏—è:** ~30 –º–∏–Ω—É—Ç

---

### ‚úÖ A08:2021 ‚Äî Software and Data Integrity Failures

**–†–∏—Å–∫:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ `collectionConfig` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚ùå **–û–¢–°–£–¢–°–¢–í–£–ï–¢:** –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã JSON
- ‚ùå **–û–¢–°–£–¢–°–¢–í–£–ï–¢:** Audit log –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```php
// backend/src/Application/UseCase/UpdateCollectionCardImage.php

public function execute(string $collectionPageId, string $targetPageId, string $imageUrl): void
{
    // ... –∫–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã ...
    
    // ‚úÖ –í–ê–õ–ò–î–ê–¶–ò–Ø –°–¢–†–£–ö–¢–£–†–´ collectionConfig
    $config = $collectionPage->getCollectionConfig() ?? [];
    
    if (!$this->isValidCollectionConfig($config)) {
        throw new \InvalidArgumentException('Invalid collectionConfig structure');
    }
    
    // ‚úÖ AUDIT LOG
    $this->logChange($collectionPageId, $targetPageId, $imageUrl, $userId);
    
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
}

private function isValidCollectionConfig(array $config): bool
{
    // ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
    $requiredKeys = ['sourceTypes', 'sortBy', 'sortOrder'];
    foreach ($requiredKeys as $key) {
        if (!isset($config[$key])) {
            return false;
        }
    }
    
    // ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤
    if (!is_array($config['sourceTypes'])) {
        return false;
    }
    
    // ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π enum
    $validTypes = ['article', 'guide', 'regular', 'collection'];
    foreach ($config['sourceTypes'] as $type) {
        if (!in_array($type, $validTypes)) {
            return false;
        }
    }
    
    return true;
}

private function logChange(string $collectionId, string $pageId, string $imageUrl, string $userId): void
{
    $logFile = __DIR__ . '/../../../logs/collection-changes.log';
    $entry = json_encode([
        'timestamp' => date('c'),
        'collectionId' => $collectionId,
        'pageId' => $pageId,
        'imageUrl' => $imageUrl,
        'userId' => $userId,
    ]) . PHP_EOL;
    
    file_put_contents($logFile, $entry, FILE_APPEND | LOCK_EX);
}
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü¢ LOW  
**–£—Å–∏–ª–∏—è:** ~30 –º–∏–Ω—É—Ç

---

### ‚úÖ A09:2021 ‚Äî Security Logging and Monitoring Failures

**–†–∏—Å–∫:** –ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚ö†Ô∏è **–ß–ê–°–¢–ò–ß–ù–û:** –ï—Å—Ç—å `ApiLogger`, –Ω–æ –Ω–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ –ª–æ–≥–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```php
// backend/src/Infrastructure/Security/SecurityMonitor.php

class SecurityMonitor
{
    /**
     * –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
     */
    public static function logSuspiciousActivity(string $type, array $details): void
    {
        $logFile = __DIR__ . '/../../../logs/security-alerts.log';
        
        $entry = json_encode([
            'timestamp' => date('c'),
            'type' => $type,
            'details' => $details,
            'ip' => $_SERVER['REMOTE_ADDR'] ?? 'unknown',
            'user_agent' => $_SERVER['HTTP_USER_AGENT'] ?? 'unknown',
        ]) . PHP_EOL;
        
        file_put_contents($logFile, $entry, FILE_APPEND | LOCK_EX);
        
        // ‚úÖ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –û—Ç–ø—Ä–∞–≤–∫–∞ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        if ($type === 'critical') {
            self::sendAlert($entry);
        }
    }
    
    private static function sendAlert(string $message): void
    {
        // TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É email —á–µ—Ä–µ–∑ PHPMailer
    }
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```php
// –í –ª—é–±–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:

SecurityMonitor::logSuspiciousActivity('invalid_image_url', [
    'pageId' => $pageId,
    'attemptedUrl' => $imageUrl,
    'userId' => $userId,
]);
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü¢ LOW  
**–£—Å–∏–ª–∏—è:** ~30 –º–∏–Ω—É—Ç

---

### ‚úÖ A10:2021 ‚Äî Server-Side Request Forgery (SSRF)

**–†–∏—Å–∫:** –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç–∏–Ω–æ–∫ –ø–æ –≤–Ω–µ—à–Ω–∏–º URL

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ø–ª–∞–Ω–µ:**
- ‚úÖ –ü–ª–∞–Ω –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç —Ç–æ–ª—å–∫–æ `/uploads/` (–ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã)
- ‚ö†Ô∏è **–ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ô –†–ò–°–ö:** –ï—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É external URLs

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ external URLs):**

```php
private function isValidImageUrl(string $url): bool
{
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ ...
    
    // ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ internal IPs –¥–ª—è external URLs
    if (preg_match('~^https?://~', $url)) {
        $host = parse_url($url, PHP_URL_HOST);
        $ip = gethostbyname($host);
        
        // ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö IP
        if (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE) === false) {
            return false;
        }
        
        // ‚úÖ Whitelist –¥–æ–º–µ–Ω–æ–≤ (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
        $allowedDomains = ['unsplash.com', 'images.unsplash.com'];
        $domain = implode('.', array_slice(explode('.', $host), -2));
        if (!in_array($domain, $allowedDomains)) {
            return false;
        }
    }
    
    return true;
}
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü¢ LOW (–µ—Å–ª–∏ –Ω–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ external URLs)  
**–£—Å–∏–ª–∏—è:** ~20 –º–∏–Ω—É—Ç

---

## üìã –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –º–∞–ª—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

### 1. Content Security Policy (CSP)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –í `PublicPageController` –µ—Å—Ç—å CSP headers (—Å nonce)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –¥–ª—è API endpoints

```php
// backend/src/Presentation/Controller/CollectionController.php

public function getItems(string $pageId): void
{
    // ‚úÖ CSP –¥–ª—è JSON API
    header("Content-Security-Policy: default-src 'none'; frame-ancestors 'none'");
    header('X-Content-Type-Options: nosniff');
    header('X-Frame-Options: DENY');
    
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
}
```

---

### 2. Input Validation

**–î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é UUID:**

```php
// backend/src/Presentation/Controller/CollectionController.php

public function getItems(string $pageId): void
{
    // ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è UUID
    if (!preg_match('/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/i', $pageId)) {
        http_response_code(400);
        echo json_encode(['error' => 'Invalid page ID format']);
        exit;
    }
    
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
}
```

---

### 3. Secure Headers (–≥–ª–æ–±–∞–ª—å–Ω—ã–µ)

```php
// backend/public/index.php (–¥–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ)

// ‚úÖ Security headers –¥–ª—è –≤—Å–µ—Ö –æ—Ç–≤–µ—Ç–æ–≤
header('X-Content-Type-Options: nosniff');
header('X-Frame-Options: SAMEORIGIN');
header('Referrer-Policy: strict-origin-when-cross-origin');
header('Permissions-Policy: geolocation=(), microphone=(), camera=()');

// ‚úÖ –£–¥–∞–ª–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ—Ä–≤–µ—Ä–∞ (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
header_remove('X-Powered-By');
```

---

### 4. –ó–∞—â–∏—Ç–∞ –æ—Ç CSRF (–¥–ª—è PATCH/POST/DELETE)

```php
// backend/src/Infrastructure/Security/CsrfToken.php

class CsrfToken
{
    public static function generate(): string
    {
        return bin2hex(random_bytes(32));
    }
    
    public static function validate(string $token): bool
    {
        // ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –∏–∑ —Å–µ—Å—Å–∏–∏
        // (–¢—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Å–µ—Å—Å–∏–∏)
        return true; // TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å
    }
}
```

**–î–ª—è –º–∞–ª—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤:** –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SameSite=Strict` cookies –≤–º–µ—Å—Ç–æ CSRF —Ç–æ–∫–µ–Ω–æ–≤:

```php
// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–µ—Å—Å–∏–∏:
session_set_cookie_params([
    'secure' => true,
    'httponly' => true,
    'samesite' => 'Strict' // ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç CSRF
]);
```

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ–∑–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –°–ï–ô–ß–ê–°):

1. ‚úÖ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è `updateCardImage()`** ‚Äî 30 –º–∏–Ω—É—Ç
2. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è `imageUrl`** ‚Äî 1 —á–∞—Å
3. ‚úÖ **XSS –∑–∞—â–∏—Ç–∞ –≤ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ** ‚Äî 30 –º–∏–Ω—É—Ç

**–ò—Ç–æ–≥–æ:** ~2 —á–∞—Å–∞

---

### –í–∞–∂–Ω—ã–µ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–æ production):

4. ‚úÖ **Rate limiting** ‚Äî 1 —á–∞—Å
5. ‚úÖ **HTTPS redirect** ‚Äî 10 –º–∏–Ω—É—Ç
6. ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞** ‚Äî 30 –º–∏–Ω—É—Ç
7. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è collectionConfig** ‚Äî 30 –º–∏–Ω—É—Ç

**–ò—Ç–æ–≥–æ:** ~2 —á–∞—Å–∞ 10 –º–∏–Ω—É—Ç

---

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞):

8. ‚úÖ **Security monitoring** ‚Äî 30 –º–∏–Ω—É—Ç
9. ‚úÖ **Audit log** ‚Äî 30 –º–∏–Ω—É—Ç
10. ‚úÖ **CSP –¥–ª—è API** ‚Äî 15 –º–∏–Ω—É—Ç

**–ò—Ç–æ–≥–æ:** ~1 —á–∞—Å 15 –º–∏–Ω—É—Ç

---

## üìä –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤ (–¥–æ –∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π)

| –£—è–∑–≤–∏–º–æ—Å—Ç—å | –†–∏—Å–∫ (–¥–æ) | –†–∏—Å–∫ (–ø–æ—Å–ª–µ) | –£—Å–∏–ª–∏—è |
|------------|-----------|--------------|--------|
| Broken Access Control | üî¥ HIGH | üü¢ LOW | 30 –º–∏–Ω |
| XSS —á–µ—Ä–µ–∑ imageUrl | üî¥ HIGH | üü¢ LOW | 1 —á–∞—Å |
| DoS —á–µ—Ä–µ–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ | üü° MEDIUM | üü¢ LOW | 1 —á–∞—Å |
| –ë—Ä—É—Ç—Ñ–æ—Ä—Å login | üü° MEDIUM | üü¢ LOW | 30 –º–∏–Ω |
| HTTPS –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | üü° MEDIUM | üü¢ LOW | 10 –º–∏–Ω |
| –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ | üü¢ LOW | üü¢ LOW | 30 –º–∏–Ω |

**–û–±—â–µ–µ –≤—Ä–µ–º—è –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** ~4 —á–∞—Å–∞  
**ROI:** –ó–∞—â–∏—Ç–∞ –æ—Ç 90% —Ä–µ–∞–ª—å–Ω—ã—Ö —É–≥—Ä–æ–∑ –¥–ª—è –º–∞–ª—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º MVP)

1. –î–æ–±–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –≤ `CollectionController`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `isValidImageUrl()` —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
3. –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ —Å `sanitizeImageUrl()`
4. –î–æ–±–∞–≤–∏—Ç—å HTTPS redirect

**–í—Ä–µ–º—è:** ~2 —á–∞—Å–∞ 10 –º–∏–Ω—É—Ç

---

### –§–∞–∑–∞ 2: –í–∞–∂–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ø–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π)

5. –î–æ–±–∞–≤–∏—Ç—å rate limiting
6. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
7. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é collectionConfig
8. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å secure cookies (SameSite=Strict)

**–í—Ä–µ–º—è:** ~2 —á–∞—Å–∞ 10 –º–∏–Ω—É—Ç

---

### –§–∞–∑–∞ 3: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–≤ —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞)

9. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å SecurityMonitor
10. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å audit log
11. –î–æ–±–∞–≤–∏—Ç—å email alerts –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π

**–í—Ä–µ–º—è:** ~1 —á–∞—Å 15 –º–∏–Ω—É—Ç

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

1. **OWASP Cheat Sheets:**
   - [Input Validation](https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html)
   - [XSS Prevention](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)
   - [Authentication](https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html)

2. **PHP Security Best Practices:**
   - Use prepared statements (‚úÖ already using)
   - Validate all input (‚ö†Ô∏è needs improvement)
   - Sanitize output (‚ö†Ô∏è needs improvement)
   - Keep dependencies updated

3. **Tools –¥–ª—è –º–∞–ª—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ):**
   - [Snyk](https://snyk.io/) ‚Äî —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
   - [OWASP ZAP](https://www.zaproxy.org/) ‚Äî —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
   - [PHPStan](https://phpstan.org/) ‚Äî —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

**–¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- ‚ö†Ô∏è **–û—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** 6/10
- üî¥ **–ö—Ä–∏—Ç–∏—á–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π:** 2 (Access Control, XSS)
- üü° **–í–∞–∂–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π:** 3 (Rate Limiting, HTTPS, Brute Force)

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- ‚úÖ **–û—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** 9/10
- üü¢ **–ö—Ä–∏—Ç–∏—á–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π:** 0
- üü¢ **–í–∞–∂–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π:** 0

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** ‚úÖ **–£–¢–í–ï–†–ñ–î–ê–Æ –ø–ª–∞–Ω —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –≤–Ω–µ—Å–µ–Ω–∏–µ–º –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π**

---

**–û–±—â–µ–µ –≤—Ä–µ–º—è –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** ~5.5 —á–∞—Å–æ–≤  
**MVP —Å —É—á—ë—Ç–æ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** ~11-13 —á–∞—Å–æ–≤ (–≤–º–µ—Å—Ç–æ 6-8 —á–∞—Å–æ–≤)  
**ROI:** –ó–∞—â–∏—Ç–∞ —Ä–µ–ø—É—Ç–∞—Ü–∏–∏, –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤

---

**–ü–æ–¥–ø–∏—Å—å –∞—É–¥–∏—Ç–æ—Ä–∞:** GitHub Copilot  
**–î–∞—Ç–∞:** 19 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ APPROVED WITH MANDATORY FIXES
