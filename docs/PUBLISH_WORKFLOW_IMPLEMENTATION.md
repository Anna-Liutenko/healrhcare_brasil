# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü: –æ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –¥–æ –ø—É–±–ª–∏—á–Ω–æ–≥–æ —Å–∞–π—Ç–∞

**–î–∞—Ç–∞:** 14 –æ–∫—Ç—è–±—Ä—è 2025  
**–ó–∞–¥–∞—á–∞:** –°–≤—è–∑–∞—Ç—å HTML –∏–∑ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —Å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º –Ω–∞ –ø—É–±–ª–∏—á–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

---

## 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è: –∫–∞–∫ –º—ã —Å–≤—è–∑–∞–ª–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏ –ø—É–±–ª–∏—á–Ω—ã–π —Å–∞–π—Ç

### 1.1 –ò—Å—Ö–æ–¥–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è
- **Frontend (Vue.js):** –í–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä (`editor.js`) –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç HTML —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ `exportHTML()`
- **Backend (PHP):** –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä `PageController` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –±–ª–æ–∫–∏ –≤ –ë–î —Å –¥–∞–Ω–Ω—ã–º–∏ (title, text, image)
- **–ü—É–±–ª–∏—á–Ω—ã–π —Å–∞–π—Ç:** `PublicPageController` —Ä–µ–Ω–¥–µ—Ä–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ –±–ª–æ–∫–æ–≤ **–≤ runtime**
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ –±—ã–ª–æ **–∑–∞—Ä–∞–Ω–µ–µ** —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π HTML –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î

### 1.2 –†–µ—à–µ–Ω–∏–µ: Pre-rendering –Ω–∞ publish

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    WORKFLOW –ü–£–ë–õ–ò–ö–ê–¶–ò–ò                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç/—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –≤–∏–∑—É–∞–ª—å–Ω–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
   ‚Üì
2. –ù–∞–∂–∏–º–∞–µ—Ç "üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å" ‚Üí –±–ª–æ–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î (data['title'], data['text'], etc.)
   ‚Üì
3. –ó–∞–ø—É—Å–∫–∞–µ—Ç sync.bat ‚Üí –∫–æ–ø–∏—Ä—É–µ—Ç backend/frontend —Ñ–∞–π–ª—ã –≤ XAMPP
   ‚Üì
4. –ù–∞–∂–∏–º–∞–µ—Ç "üöÄ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å" ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç PUT /api/pages/{id}/publish
   ‚Üì
5. Backend –∑–∞–ø—É—Å–∫–∞–µ—Ç use-case PublishPage:
   - –í—ã–∑—ã–≤–∞–µ—Ç RenderPageHtml (—Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥)
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π HTML: DOCTYPE ‚Üí head+CSS ‚Üí header ‚Üí main(blocks) ‚Üí footer ‚Üí cookie banner
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î –ø–æ–ª–µ rendered_html
   ‚Üì
6. –ü—É–±–ª–∏—á–Ω—ã–π —Å–∞–π—Ç (GET /{slug}) –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
   - –ï—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ published –ò –µ—Å—Ç—å rendered_html ‚Üí –æ—Ç–¥–∞—ë—Ç –≥–æ—Ç–æ–≤—ã–π HTML
   - –ò–Ω–∞—á–µ ‚Üí runtime —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ (fallback –¥–ª—è draft/preview)
```

### 1.3 –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### Backend
- **`RenderPageHtml.php`** (Use-case) ‚Äî —Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –±–ª–æ–∫–æ–≤ –≤ HTML
- **`PublishPage.php`** (Use-case) ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç RenderPageHtml –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- **`PageController::publish()`** ‚Äî endpoint –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- **`PublicPageController::show()`** ‚Äî –æ—Ç–¥–∞—ë—Ç rendered_html –¥–ª—è published —Å—Ç—Ä–∞–Ω–∏—Ü
- **`GetPageWithBlocks.php`** ‚Äî —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–µ `rendered_html`

#### Database Schema
```sql
ALTER TABLE pages 
ADD COLUMN rendered_html LONGTEXT NULL COMMENT 'Pre-rendered HTML for published pages';
```

---

## 2. –ü—Ä–æ–±–ª–µ–º—ã, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ü—É—Ç—å –∫ CSS —Ñ–∞–π–ª—É
**–°–∏–º–ø—Ç–æ–º:** –ü–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ rendered_html —Å–æ–¥–µ—Ä–∂–∞–ª —Å—Å—ã–ª–∫–∏ `<link rel="stylesheet">`, –∞ –Ω–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π CSS.

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –≤ `RenderPageHtml.php`:
```php
$cssPath = __DIR__ . '/../../../public/styles.css'; // ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
```

**–†–µ—à–µ–Ω–∏–µ:** –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—É—Ç—å —Å —É—á—ë—Ç–æ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã XAMPP:
```php
// –í XAMPP: backend –∏ frontend ‚Äî —Å–æ—Å–µ–¥–Ω–∏–µ –ø–∞–ø–∫–∏ –≤ htdocs
$cssPath = __DIR__ . '/../../../../healthcare-cms-frontend/styles.css';
if (!file_exists($cssPath)) {
    $cssPath = __DIR__ . '/../../../../frontend/styles.css'; // fallback –¥–ª—è dev
}
```

**–£—Ä–æ–∫:** –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø—É—Ç—è–º–∏ —Ñ–∞–π–ª–æ–≤ —É—á–∏—Ç—ã–≤–∞—Ç—å **–¥–≤–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è**: dev (–ª–æ–∫–∞–ª—å–Ω—ã–π backend/) –∏ production (XAMPP htdocs/).

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ë–ª–æ–∫–∏ –±–µ–∑ –≥–æ—Ç–æ–≤–æ–≥–æ HTML
**–°–∏–º–ø—Ç–æ–º:** –ü—É–±–ª–∏—á–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ —Ç–æ–ª—å–∫–æ JSON –±–ª–æ–∫–æ–≤ –≤–º–µ—Å—Ç–æ –∫—Ä–∞—Å–∏–≤–æ–π –≤—ë—Ä—Å—Ç–∫–∏.

**–ü—Ä–∏—á–∏–Ω–∞:** –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ `RenderPageHtml.php` –æ–∂–∏–¥–∞–ª –ø–æ–ª–µ `data['html']` (–≥–æ—Ç–æ–≤—É—é –≤—ë—Ä—Å—Ç–∫—É –∏–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞), –Ω–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä **–Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç** —ç—Ç–æ –ø–æ–ª–µ ‚Äî —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ (title, text, cards).

**–ü–µ—Ä–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ):**
```php
if (isset($data['html'])) {
    return $data['html']; // ‚ùå –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª–æ
}
// Fallback: –ø–æ–∫–∞–∑—ã–≤–∞–ª JSON
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å **–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –±–ª–æ–∫–æ–≤** –≤ PHP, –∫–∞–∫ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç `renderBlock()` –≤ `editor.js`:

```php
private function renderBlock(\Domain\Entity\Block $block): string
{
    $data = $block->getData() ?? [];
    $type = $block->getType();

    return match ($type) {
        'main-screen' => $this->renderMainScreen($data),
        'service-cards' => $this->renderServiceCards($data),
        'about-section' => $this->renderAboutSection($data),
        // ... –∏ —Ç.–¥. –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –±–ª–æ–∫–æ–≤
        default => '<div>Unknown block type</div>'
    };
}

private function renderServiceCards(array $data): string
{
    $title = htmlspecialchars($data['title'] ?? '', ENT_QUOTES, 'UTF-8');
    $cards = $data['cards'] ?? [];
    $cardsHtml = '';
    
    foreach ($cards as $card) {
        $cardsHtml .= '<div class="service-card">';
        $cardsHtml .= '<h3>' . htmlspecialchars($card['title']) . '</h3>';
        // ... –ø–æ–ª–Ω–∞—è –≤—ë—Ä—Å—Ç–∫–∞
    }
    
    return "<section>$title<div class=\"services-grid\">$cardsHtml</div></section>";
}
```

**–£—Ä–æ–∫:** –ù–µ –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ (—Ä–µ–¥–∞–∫—Ç–æ—Ä) –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ HTML. –°–µ—Ä–≤–µ—Ä–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º** –∏ **—Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º**.

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: PublicPageController –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª rendered_html
**–°–∏–º–ø—Ç–æ–º:** –î–∞–∂–µ –ø–æ—Å–ª–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø—É–±–ª–∏—á–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ —Å—Ç–∞—Ä—É—é –≤—ë—Ä—Å—Ç–∫—É (–±–ª–æ–∫-–æ–±—ë—Ä—Ç–∫–∏ –≤–º–µ—Å—Ç–æ `<section>`).

**–ü—Ä–∏—á–∏–Ω–∞:** `GetPageWithBlocks::serializePage()` **–Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–ª** –ø–æ–ª–µ `rendered_html`, –ø–æ—ç—Ç–æ–º—É `PublicPageController` –µ–≥–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–ª—É—á–∞–ª:

```php
// ‚ùå –î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
private function serializePage($page): array
{
    return [
        'id' => $page->getId(),
        'title' => $page->getTitle(),
        // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
        // rendered_html –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç!
    ];
}
```

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–µ–µ –ø–æ–ª–µ:
```php
// ‚úÖ –ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
private function serializePage($page): array
{
    return [
        'id' => $page->getId(),
        'title' => $page->getTitle(),
        'status' => $page->getStatus()->getValue(),
        'rendered_html' => $page->getRenderedHtml(), // ‚Üê –î–æ–±–∞–≤–∏–ª–∏
        'show_in_menu' => $page->isShowInMenu(),
        'menu_title' => $page->getMenuTitle(),
        // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
    ];
}
```

**–£—Ä–æ–∫:** –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –≤ Entity –∏ Repository **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å** –≤—Å–µ Use-cases, –∫–æ—Ç–æ—Ä—ã–µ —Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ.

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞
**–°–∏–º–ø—Ç–æ–º:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–µ–ª —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–∞–∂–µ –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∏ –æ—á–∏—Å—Ç–∫–∏ cookies.

**–ü—Ä–∏—á–∏–Ω–∞:** –ë—Ä–∞—É–∑–µ—Ä –∫–µ—à–∏—Ä–æ–≤–∞–ª HTML –ø–æ URL. –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ –æ—Ç–¥–∞–≤–∞–ª –∫–µ—à –≤–º–µ—Å—Ç–æ —Å–≤–µ–∂–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

**–†–µ—à–µ–Ω–∏–µ:**
1. –Ø–≤–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞ –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+Shift+Delete ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞)
2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–µ—à–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```php
header('Cache-Control: no-cache, must-revalidate');
header('Expires: Mon, 26 Jul 1997 05:00:00 GMT');
```

**–£—Ä–æ–∫:** –ü—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ –ø—É–±–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü **–≤—Å–µ–≥–¥–∞** –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (F12) ‚Üí –≤–∫–ª–∞–¥–∫–∞ Network ‚Üí Disable cache.

---

## 3. –ö–∞–∫ –º—ã —Ä–µ—à–∞–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã: –ø–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å

### –ò—Ç–µ—Ä–∞—Ü–∏—è 1: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–ª —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
2. –ù–∞–∂–∞–ª "–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å"
3. –û—Ç–∫—Ä—ã–ª –ø—É–±–ª–∏—á–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚Üí **–≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞** (hero-–±–ª–æ–∫)
4. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:** –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ –ë–î –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ MySQL CLI

```bash
SELECT LEFT(rendered_html, 500) FROM pages WHERE id='...';
# –†–µ–∑—É–ª—å—Ç–∞—Ç: CSS –Ω–µ –≤—Å—Ç—Ä–æ–µ–Ω, —Å—Å—ã–ª–∫–∏ <link rel="stylesheet">
```

### –ò—Ç–µ—Ä–∞—Ü–∏—è 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É—Ç–∏ –∫ CSS
1. –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ —Ñ–∞–π–ª–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É XAMPP: `Get-ChildItem C:\xampp\htdocs`
2. –û–±–Ω–∞—Ä—É–∂–∏–ª–∏: `healthcare-cms-backend` –∏ `healthcare-cms-frontend` ‚Äî –Ω–∞ –æ–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ
3. –ò—Å–ø—Ä–∞–≤–∏–ª–∏ –ø—É—Ç—å –≤ `RenderPageHtml.php`
4. –ó–∞–ø—É—Å—Ç–∏–ª–∏ `sync.bat` ‚Üí –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª–∏ ‚Üí –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ –ë–î

```bash
SELECT CASE WHEN rendered_html LIKE '%<style>%' THEN 'YES' ELSE 'NO' END as has_inline_css 
FROM pages WHERE id='...';
# –†–µ–∑—É–ª—å—Ç–∞—Ç: YES ‚úÖ
```

### –ò—Ç–µ—Ä–∞—Ü–∏—è 3: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Ä–µ–Ω–¥–µ—Ä–æ–≤ –±–ª–æ–∫–æ–≤
1. –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –±–ª–æ–∫–æ–≤ –≤ –ë–î:
```bash
SELECT type, LEFT(data, 150) FROM blocks WHERE page_id='...';
# –†–µ–∑—É–ª—å—Ç–∞—Ç: JSON —Å title/text/cards, –Ω–æ –ë–ï–ó –ø–æ–ª—è 'html'
```

2. –ò–∑—É—á–∏–ª–∏ `editor.js::renderBlock()` ‚Äî –∫–∞–∫ frontend —Ä–µ–Ω–¥–µ—Ä–∏—Ç –∫–∞–∂–¥—ã–π —Ç–∏–ø
3. –ü–µ—Ä–µ–Ω–µ—Å–ª–∏ –ª–æ–≥–∏–∫—É –≤ PHP: —Å–æ–∑–¥–∞–ª–∏ –º–µ—Ç–æ–¥—ã `renderMainScreen()`, `renderServiceCards()`, `renderAboutSection()`
4. –ó–∞–º–µ–Ω–∏–ª–∏ –ø—Ä–æ—Å—Ç–æ–π fallback –Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π match/case —Å –≤—ã–∑–æ–≤–æ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —Ä–µ–Ω–¥–µ—Ä–æ–≤

### –ò—Ç–µ—Ä–∞—Ü–∏—è 4: –§–∏–∫—Å GetPageWithBlocks
1. –û—Ç–∫—Ä—ã–ª–∏ –ø—É–±–ª–∏—á–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚Üí –≤—Å—ë –µ—â—ë —Å—Ç–∞—Ä–∞—è –≤—ë—Ä—Å—Ç–∫–∞
2. –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ —á–µ—Ä–µ–∑ `curl`:
```bash
curl http://localhost/.../novaya-stranitsa | Select-String "service-card"
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–∞—à–ª–∏ <div class="block block-hero"> –≤–º–µ—Å—Ç–æ <section class="hero">
```

3. –î–æ–±–∞–≤–∏–ª–∏ debug-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `PublicPageController`:
```php
@file_put_contents(__DIR__ . '/../../../logs/public-page-debug.log', 
    "status=" . $page['status'] . " | has_rendered_html=" . (isset($page['rendered_html']) ? 'YES' : 'NO')
);
```

4. –û–±–Ω–∞—Ä—É–∂–∏–ª–∏: `has_rendered_html=NO` ‚Üí –ø–æ–ª–µ –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏–∑ Use-case
5. –ò—Å–ø—Ä–∞–≤–∏–ª–∏ `GetPageWithBlocks::serializePage()`

---

## 4. –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –∞–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω—ã

### –ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω 1: –ù–µ–ø–æ–ª–Ω–∞—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è Entity
**–ü—Ä–æ–±–ª–µ–º–∞:** Use-case `GetPageWithBlocks` –≤–æ–∑–≤—Ä–∞—â–∞–ª –Ω–µ –≤—Å–µ –ø–æ–ª—è –∏–∑ Entity `Page`.

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø–ª–æ—Ö–æ:**
- –î—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã (–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã) **–º–æ–ª—á–∞ –ø–æ–ª—É—á–∞—é—Ç null** –≤–º–µ—Å—Ç–æ –æ–∂–∏–¥–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ù–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç–∏–ø–æ–≤ (PHP –Ω–µ –∑–Ω–∞–µ—Ç, —á—Ç–æ –ø–æ–ª–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
- –ü—Ä–∏–≤–æ–¥–∏—Ç –∫ silent bugs: –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**
- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–æ–ª—è –≤ Entity ‚Üí —Å—Ä–∞–∑—É –¥–æ–±–∞–≤–∏—Ç—å –≤ –í–°–ï –º–µ—Ç–æ–¥—ã —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DTO (Data Transfer Objects) —Å —è–≤–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏
- –ü–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã, –ø—Ä–æ–≤–µ—Ä—è—é—â–∏–µ –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π

**–ü—Ä–∏–º–µ—Ä:**
```php
// ‚ùå –ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω
private function serializePage($page): array
{
    return ['id' => $page->getId(), 'title' => $page->getTitle()]; // –∑–∞–±—ã–ª–∏ rendered_html
}

// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ: —è–≤–Ω—ã–π —Å–ø–∏—Å–æ–∫
private function serializePage($page): array
{
    return [
        'id' => $page->getId(),
        'title' => $page->getTitle(),
        'slug' => $page->getSlug(),
        'status' => $page->getStatus()->getValue(),
        'rendered_html' => $page->getRenderedHtml(),
        // ... –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª–µ–π
    ];
}
```

---

### –ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω 2: Hardcoded –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—É—Ç—å –∫ CSS –±—ã–ª –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω –¥–ª—è –æ–¥–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è (dev).

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø–ª–æ—Ö–æ:**
- –ö–æ–¥ –ª–æ–º–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ –≤ –¥—Ä—É–≥–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (XAMPP, production)
- –ù–µ—Ç –µ–¥–∏–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø—Ä–∞–≤–¥—ã –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env` —Ñ–∞–π–ª)
- Fallback-–º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ü—Ä–∏–º–µ—Ä:**
```php
// ‚ùå –ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω
$cssPath = __DIR__ . '/../../../public/styles.css';

// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ: –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å fallback
$cssPath = getenv('FRONTEND_PATH') 
    ? getenv('FRONTEND_PATH') . '/styles.css' 
    : __DIR__ . '/../../../../healthcare-cms-frontend/styles.css';
    
if (!file_exists($cssPath)) {
    $cssPath = __DIR__ . '/../../../../frontend/styles.css'; // dev fallback
}
```

---

### –ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω 3: –ü–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –ª–æ–≥–∏–∫–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** –û–∂–∏–¥–∞–ª–∏, —á—Ç–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω–∏—Ç `data['html']` —Å –≥–æ—Ç–æ–≤–æ–π –≤—ë—Ä—Å—Ç–∫–æ–π.

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø–ª–æ—Ö–æ:**
- –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è (—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥, –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è)
- –°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∑–∞–≤–∏—Å–∏–º–æ–π –æ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏—è frontend
- –ù–∞—Ä—É—à–∞–µ—Ç—Å—è –ø—Ä–∏–Ω—Ü–∏–ø —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**
- –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **—Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º**: –∏–º–µ—Ç—å –≤—Å—é –ª–æ–≥–∏–∫—É –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
- –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç **–¥–∞–Ω–Ω—ã–µ** (title, text), –∞ –Ω–µ –≤—ë—Ä—Å—Ç–∫—É
- –°–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –¥—É–±–ª–∏—Ä—É–µ—Ç –ª–æ–≥–∏–∫—É —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ (DRY –Ω–∞—Ä—É—à–∞–µ—Ç—Å—è, –Ω–æ gain –≤ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏)

**–ü—Ä–∏–º–µ—Ä:**
```php
// ‚ùå –ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω: –∂–¥—ë–º –≥–æ—Ç–æ–≤—ã–π HTML –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞
if (isset($data['html'])) {
    return $data['html']; // —á—Ç–æ –µ—Å–ª–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç —ç—Ç–æ –ø–æ–ª–µ?
}

// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ: —Å–µ—Ä–≤–µ—Ä —Å–∞–º —Ä–µ–Ω–¥–µ—Ä–∏—Ç
private function renderServiceCards(array $data): string
{
    // –ü–æ–ª–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
    $cards = $data['cards'] ?? [];
    $html = '<section><div class="services-grid">';
    foreach ($cards as $card) {
        $html .= $this->renderServiceCard($card);
    }
    return $html . '</div></section>';
}
```

---

### –ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω 4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—ã—Ç–∞–ª–∏—Å—å –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É `rendered_html` –Ω–µ –æ—Ç–¥–∞—ë—Ç—Å—è, –Ω–æ –Ω–µ –±—ã–ª–æ –ª–æ–≥–æ–≤.

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø–ª–æ—Ö–æ:**
- Debugging –º–µ—Ç–æ–¥–æ–º "—Ç—ã–∫–∞": –º–µ–Ω—è–µ–º –∫–æ–¥ ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ–º ‚Üí –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –Ω–µ –ø–æ–Ω–∏–º–∞–µ–º –ø–æ—á–µ–º—É
- –¢—Ä–∞—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –ø—Ä–æ–≤–µ—Ä–æ–∫

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**
- –ü—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ **—Å—Ä–∞–∑—É** –¥–æ–±–∞–≤–ª—è—Ç—å debug-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —É—Å–ª–æ–≤–∏—è if/else, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –ü–æ—Å–ª–µ —Ñ–∏–∫—Å–∞ ‚Äî –ª–∏–±–æ —É–±—Ä–∞—Ç—å, –ª–∏–±–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞ feature flag (`E2E_DEBUG=1`)

**–ü—Ä–∏–º–µ—Ä:**
```php
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ: –ª–æ–≥–∏—Ä—É–µ–º –≤—Å—ë –≤–∞–∂–Ω–æ–µ
@file_put_contents(__DIR__ . '/../../../logs/debug.log', 
    date('c') . " | slug=$slug | status=" . ($page['status'] ?? 'null') . 
    " | has_rendered_html=" . (isset($page['rendered_html']) ? 'YES' : 'NO') . 
    " | html_length=" . strlen($page['rendered_html'] ?? '') . PHP_EOL, 
    FILE_APPEND | LOCK_EX
);
```

---

## 5. –ö–∞–∫ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã –≤ –±—É–¥—É—â–µ–º

### 5.1 –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –≤ Entity

- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –≤ Entity –∫–ª–∞—Å—Å (`Domain\Entity\Page`)
- [ ] –î–æ–±–∞–≤–∏—Ç—å getter/setter –º–µ—Ç–æ–¥—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å Repository (—á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å –≤ –ë–î)
- [ ] **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –í–°–ï Use-cases**, –∫–æ—Ç–æ—Ä—ã–µ —Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç Entity:
  - `GetPageWithBlocks::serializePage()`
  - `GetPage::execute()`
  - –õ—é–±—ã–µ –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–µ –º–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î (`ALTER TABLE ... ADD COLUMN ...`)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ö–µ–º—É (`tests/schema.sql`)
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç, –ø—Ä–æ–≤–µ—Ä—è—é—â–∏–π –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª—è

---

### 5.2 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏–π

**–°–æ–∑–¥–∞—Ç—å `.env` —Ñ–∞–π–ª –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```env
# .env.example
APP_ENV=development
FRONTEND_PATH=/path/to/frontend
CSS_FILE_PATH=${FRONTEND_PATH}/styles.css
ENABLE_DEBUG_LOGGING=true
```

**–í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
```php
$cssPath = getenv('CSS_FILE_PATH') ?: $this->getDefaultCssPath();
```

---

### 5.3 –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

**–¢–µ—Å—Ç: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ—Ç—ã —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏**
```php
public function testGetPageWithBlocksReturnsRenderedHtml(): void
{
    $page = $this->createPublishedPageWithHtml();
    $result = $this->useCase->execute($page->getId());
    
    $this->assertArrayHasKey('rendered_html', $result['page']);
    $this->assertNotEmpty($result['page']['rendered_html']);
    $this->assertStringContainsString('<section class="hero">', $result['page']['rendered_html']);
}
```

**–¢–µ—Å—Ç: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –±–ª–æ–∫–æ–≤**
```php
public function testRenderPageHtmlIncludesAllBlocks(): void
{
    $page = $this->createPageWithBlocks([
        ['type' => 'main-screen', 'data' => ['title' => 'Test']],
        ['type' => 'service-cards', 'data' => ['cards' => [...]]],
    ]);
    
    $html = $this->renderUseCase->execute($page);
    
    $this->assertStringContainsString('<section class="hero">', $html);
    $this->assertStringContainsString('<div class="services-grid">', $html);
    $this->assertStringContainsString('<footer class="main-footer">', $html);
}
```

---

### 5.4 Code Review Checklist

–ü—Ä–∏ —Ä–µ–≤—å—é PR —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏/—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å:

- [ ] –í—Å–µ –ø–æ–ª—è Entity –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- [ ] –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –Ω–µ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã (–∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é)
- [ ] –ï—Å—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- [ ] –õ–æ–≥–∏–∫–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞)
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–æ debug-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (–∑–∞ feature flag)
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª!)

---

## 6. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º—Ç—ã –¥–ª—è LLM

### ‚ùå –ü–ª–æ—Ö–æ–π –ø—Ä–æ–º—Ç (—Ä–∞—Å–ø–ª—ã–≤—á–∞—Ç—ã–π)
> "–°–¥–µ–ª–∞–π —Ç–∞–∫, —á—Ç–æ–±—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—É–±–ª–∏–∫–æ–≤–∞–ª–∏—Å—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ"

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ù–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: —á—Ç–æ —Ç–∞–∫–æ–µ "–ø—Ä–∞–≤–∏–ª—å–Ω–æ"?
- –ù–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ç–∞–ª–µ–π: –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã?
- LLM –≤—ã–Ω—É–∂–¥–µ–Ω–∞ –≥–∞–¥–∞—Ç—å –∏ –º–æ–∂–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–µ —Ç–æ —Ä–µ—à–µ–Ω–∏–µ

---

### ‚úÖ –•–æ—Ä–æ—à–∏–π –ø—Ä–æ–º—Ç (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)

**–®–∞–±–ª–æ–Ω:**
```
–ö–û–ù–¢–ï–ö–°–¢:
- –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (—á—Ç–æ –µ—Å—Ç—å)
- –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (—á—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- –ü—Ä–∏–ª–æ–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã/–∫–æ–¥ (—á—Ç–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å)

–ó–ê–î–ê–ß–ê:
- –ß—ë—Ç–∫–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞: —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å
- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –∫–∞–∫ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: —á—Ç–æ –ù–ï —Ç—Ä–æ–≥–∞—Ç—å / —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò:
- –ù–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å
- –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã/–∫–ª–∞—Å—Å—ã
- –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö (API responses, JSON structure)

–ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê:
- –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
- –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤ –∏–ª–∏ —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
```

---

### –ü—Ä–∏–º–µ—Ä: –ü—Ä–æ–º—Ç –¥–ª—è —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏

```markdown
–ö–û–ù–¢–ï–ö–°–¢:
–£ –º–µ–Ω—è –µ—Å—Ç—å CMS —Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º (Vue.js) –∏ backend –Ω–∞ PHP (Clean Architecture).
–†–µ–¥–∞–∫—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –±–ª–æ–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –ë–î —Å –¥–∞–Ω–Ω—ã–º–∏ (title, text, cards).
–ü—É–±–ª–∏—á–Ω—ã–π —Å–∞–π—Ç —Ä–µ–Ω–¥–µ—Ä–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ –±–ª–æ–∫–æ–≤ –≤ runtime —á–µ—Ä–µ–∑ PublicPageController.

–ü–†–û–ë–õ–ï–ú–ê:
–ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è "–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å" –ø—É–±–ª–∏—á–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (hero-–±–ª–æ–∫).
–û—Å—Ç–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ (service-cards, about-section) –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è.

–ü–†–ò–õ–û–ñ–ï–ù–ù–´–ï –§–ê–ô–õ–´:
- backend/src/Presentation/Controller/PublicPageController.php (–∫–∞–∫ –æ—Ç–¥–∞—ë—Ç—Å—è –ø—É–±–ª–∏—á–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞)
- backend/src/Application/UseCase/RenderPageHtml.php (—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ HTML)
- frontend/editor.js::exportHTML() (–∫–∞–∫ —Ä–µ–¥–∞–∫—Ç–æ—Ä –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç HTML)
- –°–∫—Ä–∏–Ω—à–æ—Ç –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (—á—Ç–æ –≤–∏–∂—É)
- SQL –∑–∞–ø—Ä–æ—Å: SELECT rendered_html FROM pages (—á—Ç–æ –≤ –ë–î)

–ó–ê–î–ê–ß–ê:
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å pre-rendering: –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π HTML –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –ø–æ–ª–µ pages.rendered_html.
–ü—É–±–ª–∏—á–Ω—ã–π —Å–∞–π—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–¥–∞–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π HTML –¥–ª—è published —Å—Ç—Ä–∞–Ω–∏—Ü.

–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø:
1. –î–æ–±–∞–≤–∏—Ç—å use-case PublishPage, –∫–æ—Ç–æ—Ä—ã–π:
   - –í—ã–∑—ã–≤–∞–µ—Ç RenderPageHtml
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ë–î (–ø–æ–ª–µ rendered_html)
   
2. RenderPageHtml –¥–æ–ª–∂–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π HTML:
   - DOCTYPE + head —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º CSS (–∏–∑ frontend/styles.css)
   - Header —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π
   - Main —Å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤ (match/case –ø–æ —Ç–∏–ø—É –±–ª–æ–∫–∞)
   - Footer —Å –∫–æ–ø–∏—Ä–∞–π—Ç–æ–º
   - Cookie banner

3. PublicPageController::show() –¥–æ–ª–∂–µ–Ω:
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å: –µ—Å–ª–∏ status='published' –ò –µ—Å—Ç—å rendered_html ‚Üí –æ—Ç–¥–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π HTML
   - –ò–Ω–∞—á–µ ‚Üí runtime —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ (–¥–ª—è draft/preview)

4. GetPageWithBlocks::serializePage() –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø–æ–ª–µ rendered_html

–û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø:
- –ù–ï –º–µ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î (–∫—Ä–æ–º–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è rendered_html LONGTEXT NULL)
- –ù–ï –º–µ–Ω—è—Ç—å API –∫–æ–Ω—Ç—Ä–∞–∫—Ç PageController (—Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ publish)
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: draft —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ-—Å—Ç–∞—Ä–æ–º—É

–ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê:
1. –ü–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—É–±–ª–∏—á–Ω—ã–π —Å–∞–π—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
   - Header (–ª–æ–≥–æ—Ç–∏–ø "Healthcare Hacks Brazil", –Ω–∞–≤–∏–≥–∞—Ü–∏—è)
   - –í—Å–µ –±–ª–æ–∫–∏ (hero, service-cards, about-section)
   - Footer (–∫–æ–ø–∏—Ä–∞–π—Ç, —Å—Å—ã–ª–∫–∞ –Ω–∞ privacy)
   - Cookie banner
   
2. –í –ë–î –ø–æ–ª–µ rendered_html —Å–æ–¥–µ—Ä–∂–∏—Ç:
   - –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ (<style>...</style>, –Ω–µ <link>)
   - –ü–æ–ª–Ω—ã–π HTML —Å DOCTYPE

3. –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç: PublishPageFlowTest –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ rendered_html —Å–æ–∑–¥–∞—ë—Ç—Å—è –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
```

---

### –ü–æ—á–µ–º—É —ç—Ç–æ—Ç –ø—Ä–æ–º—Ç —Ö–æ—Ä–æ—à–∏–π:

1. **–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–Ω—è—Ç–µ–Ω:** LLM –∑–Ω–∞–µ—Ç, —Å –∫–∞–∫–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç
2. **–ü—Ä–æ–±–ª–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–∞:** –ø–æ–Ω—è—Ç–Ω–æ, –≥–¥–µ –∏—Å–∫–∞—Ç—å –±–∞–≥ (PublicPageController –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç rendered_html)
3. **–ó–∞–¥–∞—á–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞:** —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. **–û–∂–∏–¥–∞–Ω–∏–µ —è–≤–Ω–æ–µ:** –∫–∞–∫ –¥–æ–ª–∂–Ω–æ –≤—ã–≥–ª—è–¥–µ—Ç—å –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
5. **–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏:** –∫–∞–∫ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

---

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –¥–ª—è –ø—Ä–æ–º—Ç–æ–≤

#### 1. –ü—Ä–∏–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ –∫–æ–¥ –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã
```markdown
–í–æ—Ç —Ç–µ–∫—É—â–∏–π –∫–æ–¥ –º–µ—Ç–æ–¥–∞:
```php
public function show(string $slug): void
{
    // ... –∫–æ–¥
}
```

–í–æ—Ç —á—Ç–æ —è –≤–∏–∂—É –Ω–∞ —ç–∫—Ä–∞–Ω–µ: [—Å–∫—Ä–∏–Ω—à–æ—Ç]
–í–æ—Ç —á—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: [–æ–ø–∏—Å–∞–Ω–∏–µ]
```

#### 2. –£–∫–∞–∑—ã–≤–∞–π—Ç–µ –≤–µ—Ä—Å–∏–∏ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```markdown
- PHP 8.2.12
- MySQL 8.0
- Vue.js 3.x
- –û–∫—Ä—É–∂–µ–Ω–∏–µ: XAMPP –Ω–∞ Windows, –ø—É—Ç—å htdocs/healthcare-cms-backend
```

#### 3. –†–∞–∑–±–∏–≤–∞–π—Ç–µ —Å–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏ –Ω–∞ –ø–æ–¥–∑–∞–¥–∞—á–∏
```markdown
–ó–∞–¥–∞—á–∞ 1: –î–æ–±–∞–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î –¥–ª—è rendered_html
–ó–∞–¥–∞—á–∞ 2: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å RenderPageHtml use-case
–ó–∞–¥–∞—á–∞ 3: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ PublishPage
–ó–∞–¥–∞—á–∞ 4: –û–±–Ω–æ–≤–∏—Ç—å PublicPageController
```

#### 4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –≤—Ö–æ–¥–Ω—ã—Ö/–≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```markdown
–í–•–û–î (–±–ª–æ–∫ –≤ –ë–î):
{
  "type": "service-cards",
  "data": {
    "title": "–ß–µ–º —è –º–æ–≥—É –ø–æ–º–æ—á—å",
    "cards": [{"icon": "üìã", "title": "–ì–∞–π–¥—ã", "text": "..."}]
  }
}

–í–´–•–û–î (HTML):
<section>
  <div class="container">
    <h2>–ß–µ–º —è –º–æ–≥—É –ø–æ–º–æ—á—å</h2>
    <div class="services-grid">
      <div class="service-card">
        <div class="icon">üìã</div>
        <h3>–ì–∞–π–¥—ã</h3>
        <p>...</p>
      </div>
    </div>
  </div>
</section>
```

#### 5. –£–∫–∞–∑—ã–≤–∞–π—Ç–µ, —á—Ç–æ –ù–ï –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å
```markdown
–ù–ï –ù–£–ñ–ù–û:
- –ú–µ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã blocks
- –£–¥–∞–ª—è—Ç—å runtime —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ (–Ω—É–∂–µ–Ω –¥–ª—è draft)
- –ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å –≤–µ—Å—å PublicPageController
```

---

## 7. –ò—Ç–æ–≥–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (as-built)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                          –ü–£–ë–õ–ò–ö–ê–¶–ò–Ø –°–¢–†–ê–ù–ò–¶                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

FRONTEND (Vue.js)
‚îú‚îÄ‚îÄ editor.html ‚Üê –í–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä
‚îú‚îÄ‚îÄ editor.js
‚îÇ   ‚îú‚îÄ‚îÄ exportHTML() ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç preview (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)
‚îÇ   ‚îú‚îÄ‚îÄ savePage() ‚Üí POST/PUT /api/pages ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –±–ª–æ–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ publishPage() ‚Üí PUT /api/pages/{id}/publish ‚Äî –ø—É–±–ª–∏–∫—É–µ—Ç
‚îÇ
‚îî‚îÄ‚îÄ utils/mappers.js
    ‚îî‚îÄ‚îÄ blockToAPI() ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –±–ª–æ–∫ –≤ API —Ñ–æ—Ä–º–∞—Ç (data –±–µ–∑ 'html')

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

BACKEND (PHP)
‚îú‚îÄ‚îÄ Domain/Entity/Page.php
‚îÇ   ‚îú‚îÄ‚îÄ rendered_html: ?string ‚Üê –ù–æ–≤–æ–µ –ø–æ–ª–µ
‚îÇ   ‚îî‚îÄ‚îÄ getRenderedHtml(), setRenderedHtml()
‚îÇ
‚îú‚îÄ‚îÄ Infrastructure/Repository/MySQLPageRepository.php
‚îÇ   ‚îú‚îÄ‚îÄ save() ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç rendered_html
‚îÇ   ‚îî‚îÄ‚îÄ findBySlug() ‚Äî —á–∏—Ç–∞–µ—Ç rendered_html
‚îÇ
‚îú‚îÄ‚îÄ Application/UseCase/
‚îÇ   ‚îú‚îÄ‚îÄ RenderPageHtml.php ‚Üê ‚≠ê –ö–õ–Æ–ß–ï–í–û–ô –ö–û–ú–ü–û–ù–ï–ù–¢
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ execute(Page) ‚Üí string (–ø–æ–ª–Ω—ã–π HTML)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ renderBlock() ‚Äî dispatch –ø–æ —Ç–∏–ø—É –±–ª–æ–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ renderMainScreen() ‚Äî <section class="hero">
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ renderServiceCards() ‚Äî <section><div class="services-grid">
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ renderAboutSection() ‚Äî <section class="about-section">
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ renderCookieBanner() ‚Äî cookie consent
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ PublishPage.php ‚Üê Use-case –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ execute(pageId) ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç RenderPageHtml ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ GetPageWithBlocks.php ‚Üê ‚≠ê –ò–°–ü–†–ê–í–õ–ï–ù–û
‚îÇ       ‚îî‚îÄ‚îÄ serializePage() ‚Äî —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç rendered_html
‚îÇ
‚îî‚îÄ‚îÄ Presentation/Controller/
    ‚îú‚îÄ‚îÄ PageController.php
    ‚îÇ   ‚îî‚îÄ‚îÄ publish() ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç PublishPage use-case
    ‚îÇ
    ‚îî‚îÄ‚îÄ PublicPageController.php ‚Üê ‚≠ê –ò–°–ü–†–ê–í–õ–ï–ù–û
        ‚îî‚îÄ‚îÄ show(slug)
            ‚îú‚îÄ‚îÄ if (published && rendered_html) ‚Üí echo rendered_html
            ‚îî‚îÄ‚îÄ else ‚Üí runtime render (fallback)

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

DATABASE (MySQL)
‚îî‚îÄ‚îÄ pages
    ‚îú‚îÄ‚îÄ id VARCHAR(36) PRIMARY KEY
    ‚îú‚îÄ‚îÄ title VARCHAR(255)
    ‚îú‚îÄ‚îÄ slug VARCHAR(255) UNIQUE
    ‚îú‚îÄ‚îÄ status ENUM('draft', 'published')
    ‚îî‚îÄ‚îÄ rendered_html LONGTEXT NULL ‚Üê –ù–æ–≤–æ–µ –ø–æ–ª–µ (‚âà20KB –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
```

---

## 8. –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

‚úÖ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç rendered_html (~21KB —Å CSS)
- –ü—É–±–ª–∏—á–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –±–ª–æ–∫–∏ (hero, service-cards, about-section, footer, cookie banner)
- Draft —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ runtime —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ (fallback)

‚úÖ **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:**
- 4 integration —Ç–µ—Å—Ç–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç (PublishPageFlowTest, MenuTitleTest)
- E2E HTTP —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç (create ‚Üí publish ‚Üí verify)
- –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è: —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –±–ª–æ–∫–æ–≤ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ (RenderPageHtml)

‚úÖ **Performance:**
- –ü—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ—Ç–¥–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (–≥–æ—Ç–æ–≤—ã–π HTML –∏–∑ –ë–î)
- –ù–µ—Ç runtime —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –¥–ª—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- CSS –≤—Å—Ç—Ä–æ–µ–Ω –≤ HTML ‚Üí 1 HTTP –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ 3 (HTML + styles.css + editor-preview.css)

---

## 9. –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ TODO

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **Hardcoded globalSettings:**
   - Header/footer —Ç–µ–∫—Å—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω –≤ `RenderPageHtml::getGlobalSettings()`
   - **TODO:** –í—ã–Ω–µ—Å—Ç–∏ –≤ —Ç–∞–±–ª–∏—Ü—É –ë–î `site_settings` –∏–ª–∏ config —Ñ–∞–π–ª

2. **–ú–µ–¥–∏–∞—Ç–µ–∫–∞: –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏—Å—á–µ–∑–∞—é—Ç –ø—Ä–∏ –∏—Ç–µ—Ä–∞—Ü–∏—è—Ö:**
   - –ü—Ä–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–∏ –ë–î –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ–¥–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Ç–µ—Ä—è—é—Ç—Å—è
   - **TODO (–∑–∞–≤—Ç—Ä–∞):** –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É + —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ uploads/

3. **–ù–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è rendered_html:**
   - –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –±–ª–æ–∫–∞ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è —Ç–µ—Ä—è–µ—Ç—Å—è
   - **TODO:** –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `page_versions` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏

4. **Markdown —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
   - –•–æ—Ç—è –µ—Å—Ç—å MarkdownRenderer, –±–ª–æ–∫–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç Markdown –≤ title/text
   - **TODO:** –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É Markdown –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—è—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## 10. –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å rendered_html –≤ –ë–î
```bash
& "C:\xampp\mysql\bin\mysql.exe" -u root healthcare_cms -e "SELECT id, slug, status, LENGTH(rendered_html) as html_length FROM pages WHERE status='published'"
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤—Å—Ç—Ä–æ–µ–Ω –ª–∏ CSS
```bash
& "C:\xampp\mysql\bin\mysql.exe" -u root healthcare_cms -e "SELECT CASE WHEN rendered_html LIKE '%<style>%' THEN 'YES' ELSE 'NO' END as has_inline_css FROM pages WHERE slug='novaya-stranitsa'"
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É–±–ª–∏—á–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ curl
```bash
curl.exe -s "http://localhost/healthcare-cms-backend/novaya-stranitsa" | Select-String "hero|service-card|about-section|footer"
```

### –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```powershell
Invoke-RestMethod -Uri "http://localhost/healthcare-cms-backend/api/pages/{PAGE_ID}/publish" -Method Put
```

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å XAMPP
```bash
.\sync.bat
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ß—Ç–æ –ø–æ–ª—É—á–∏–ª–∏:**
- ‚úÖ –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π pre-rendering —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î
- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ—Ç–¥–∞—é—Ç –≥–æ—Ç–æ–≤—ã–π HTML –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- ‚úÖ –†–µ–¥–∞–∫—Ç–æ—Ä –∏ –ø—É–±–ª–∏—á–Ω—ã–π —Å–∞–π—Ç –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç (WYSIWYG)
- ‚úÖ Clean Architecture —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞: Use-cases, Repository, Controller
- ‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, E2E —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ß–µ–º—É –Ω–∞—É—á–∏–ª–∏—Å—å:**
- üéì –í–∞–∂–Ω–æ—Å—Ç—å –ø–æ–ª–Ω–æ–π —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Entity –≤–æ –≤—Å–µ—Ö Use-cases
- üéì –°–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º (–Ω–µ –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞)
- üéì Debug-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –∫—Ä–∏—Ç–∏—á–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ
- üéì Structured –ø—Ä–æ–º—Ç—ã –¥–ª—è LLM —ç–∫–æ–Ω–æ–º—è—Ç –≤—Ä–µ–º—è –∏ –¥–∞—é—Ç —Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- üéì –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–±–æ—Ç—É –≤ –¥–≤—É—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö: dev –∏ XAMPP

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ: –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç end-to-end
2. üîú –ó–∞–≤—Ç—Ä–∞: –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å –∏—Å—á–µ–∑–∞—é—â–∏–º–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏
3. üîú –ë—É–¥—É—â–µ–µ: –≤—ã–Ω–µ—Å—Ç–∏ globalSettings –≤ –ë–î
4. üîú –ë—É–¥—É—â–µ–µ: –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ rendered_html

---

**–ê–≤—Ç–æ—Ä:** –ê–Ω–Ω–∞ –õ—é—Ç–µ–Ω–∫–æ + GitHub Copilot  
**–î–∞—Ç–∞:** 14 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0

---

## Controller fallback policy & CI integration

–ö–æ—Ä–æ—Ç–∫–æ: –Ω–∞ –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º—ã –æ—Å—Ç–∞–≤–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–Ω—ã–π —Ñ–∏–∫—Å `PublicPageController::fixUploadsUrls()` –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –ø–ª–∞–Ω. –≠—Ç–æ—Ç —Ñ–∏–∫—Å –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º ‚Äî –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞ –º—ã –ø–æ–ª–∞–≥–∞–µ–º—Å—è –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ (DocumentRoot/Alias) –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ post-deploy –ø—Ä–æ–≤–µ—Ä–∫–∏.

–ß—Ç–æ –¥–µ–ª–∞–µ–º —Å–µ–π—á–∞—Å
- –û—Å—Ç–∞–≤–ª—è–µ–º `fixUploadsUrls()` –≤–∫–ª—é—á—ë–Ω–Ω—ã–º –≤ —Ä–∞–±–æ—á–µ–π –≤–µ—Ç–∫–µ (safety-net). –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å downtime –ø–æ–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –Ω–µ –≤—ã–≤–µ—Ä–µ–Ω—ã.
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ ‚Äî –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ–º post-deploy —Å–∫—Ä–∏–ø—Ç `deploy/hooks/post_deploy_uploads_check.sh` –≤ pipeline (CI) –∏ –¥–µ–ª–∞–µ–º –µ–≥–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º: –ø—Ä–∏ –æ—à–∏–±–∫–µ (missing files) CI –¥–æ–ª–∂–µ–Ω –ø–æ–º–µ—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π –∫–∞–∫ –Ω–µ—É—Å–ø–µ—à–Ω—ã–π.

CI integration (–ø—Ä–∏–º–µ—Ä, GitLab CI / GitHub Actions / –ª—é–±–æ–π CI):

1) –®–∞–≥ –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ (–ø–æ—Å–ª–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏ –º–∏–≥—Ä–∞—Ü–∏–π):

     - –°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º —Ö—É–∫ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–º —Ö–æ—Å—Ç–µ (ssh):

```bash
# –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ CI runner (–ø—Ä–∏–º–µ—Ä GitLab) –ø–æ SSH –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω-—Ö–æ—Å—Ç
ssh deploy@prod.example.com 'sudo chmod +x /var/www/healthcare-cms-backend/deploy/hooks/post_deploy_uploads_check.sh && sudo /var/www/healthcare-cms-backend/deploy/hooks/post_deploy_uploads_check.sh'
```

2) –ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –≤–µ—Ä–Ω—É–ª –Ω–µ–Ω—É–ª–µ–≤–æ–π –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä 5 –ø—Ä–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö missing files), pipeline –¥–æ–ª–∂–µ–Ω –æ—Ç–º–µ–Ω–∏—Ç—å/–æ—Ç–∫–∞—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª –∫–æ–º–∞–Ω–¥—ã (Slack/email).

Report handling
- –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—ë—Ç `deploy-reports/pages-images-report.json` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. CI —à–∞–≥ –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª –∫–∞–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –∏–ª–∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å –µ–≥–æ –≤ –º–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.
- –ü—Ä–∏–º–µ—Ä: –≤ GitLab CI –¥–æ–±–∞–≤–∏—Ç—å `artifacts: { paths: ["deploy-reports/pages-images-report.json"] }` –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è.

Removal plan for controller fallback
- –£—Å–ª–æ–≤–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è `fixUploadsUrls()` –∏–∑ `PublicPageController`:
    1. 3 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ø–µ—à–Ω—ã—Ö –¥–µ–ø–ª–æ—è –Ω–∞ production —Å –Ω—É–ª–µ–≤—ã–º `missing_files_total` –≤ –æ—Ç—á—ë—Ç–∞—Ö.
    2. –ù–∞–ª–∏—á–∏–µ CI-–∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤/–ª–æ–≥–æ–≤ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–∏—Ö, —á—Ç–æ `curl -I 'https://prod.example.com/uploads/<sample-file>'` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç HTTP 200 –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π Content-Type.
    3. –†–µ–≤—å—é –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –≤ PR ‚Äî –æ—Ç–∫–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–º pull request —Å —Ç–µ—Å—Ç–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ–º.

- –û—Ç–∫–∞—Ç (–ø—Ä–∏–º–µ—Ä–Ω—ã–π –Ω–∞–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏–π):
    1. –°–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É `revert/fix-uploads-controller`.
    2. –í–Ω–µ—Å—Ç–∏ –ø–∞—Ç—á: —É–¥–∞–ª–∏—Ç—å –º–µ—Ç–æ–¥ `fixUploadsUrls()` –∏ –≤—ã–∑–æ–≤—ã –∫ –Ω–µ–º—É –≤ `PublicPageController`.
    3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏ —Å–∫—Ä–∏–ø—Ç `backend/scripts/check-pages-images.php` –ª–æ–∫–∞–ª—å–Ω–æ.
    4. –û—Ç–∫—Ä—ã—Ç—å PR, –ø—Ä–æ–π—Ç–∏ code review –∏ –ø—Ä–æ–≤–µ—Å—Ç–∏ canary-–¥–µ–ø–ª–æ–π (staging) ‚Äî –ø—Ä–æ–≥–Ω–∞—Ç—å post-deploy hook –∏ smoke curl.
    5. –ï—Å–ª–∏ –≤—Å—ë OK ‚Äî merge –∏ –¥–µ–ø–ª–æ–π –≤ production.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–Ω–æ–≥–æ fallback –æ—Å—Ç–∞–≤—å—Ç–µ –Ω–∞ 7 –¥–Ω–µ–π debug-–ª–æ–≥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ `fixUploadsUrls()` –∑–∞–º–µ–Ω—è–ª –ø—É—Ç—å (–ª–æ–≥ —Å timestamp, slug, –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π src). –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —É–≤–∏–¥–µ—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –æ—Ü–µ–Ω–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä–æ –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å —Ñ–∏–∫—Å.

–ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏ –ª–æ–≥–æ–≤ (–≤ `PublicPageController`):

```php
@file_put_contents(__DIR__ . '/../../../logs/uploads-fallback.log', date('c') . " | slug={$slug} | replaced_count={$replacements}\n", FILE_APPEND | LOCK_EX);
```

---

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ, —è –º–æ–≥—É –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å:
- PR –¥–ª—è –æ—Ç–∫–∞—Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–Ω–æ–≥–æ —Ñ–∏–∫—Å–∞ (–≥–æ—Ç–æ–≤ –∫ —Å–æ–∑–¥–∞–Ω–∏—é, –Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Removal plan);
- –ü—Ä–∏–º–µ—Ä Job snippet –¥–ª—è GitLab CI / GitHub Actions, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç post-deploy hook –ø–æ SSH –∏ —Å–æ–±–∏—Ä–∞–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –æ—Ç—á—ë—Ç–∞.

–í—ã–±–µ—Ä–∏—Ç–µ, —á—Ç–æ —Å–¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º: "–ø–æ–¥–≥–æ—Ç–æ–≤—å PR –Ω–∞ –æ—Ç–∫–∞—Ç" –∏–ª–∏ "–ø–æ–¥–≥–æ—Ç–æ–≤—å CI job snippet" –∏ —è –≤–Ω–µ—Å—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã/–ø—Ä–∏–º–µ—Ä—ã.
