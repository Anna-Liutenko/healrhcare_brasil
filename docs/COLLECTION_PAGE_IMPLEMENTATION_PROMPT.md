# ü§ñ –ü—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Collection Page

**–î–∞—Ç–∞:** 19 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0 –¥–ª—è –º–∞–ª–æ–º–æ—â–Ω—ã—Ö LLM  
**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** Clean Architecture (PHP 8.x + MySQL + Vue.js)

---

## üìå –ö–æ–Ω—Ç–µ–∫—Å—Ç —Å–∏—Å—Ç–µ–º—ã

**–ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ CMS –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü (Regular, Article, Guide, Collection)
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Ç–∞–±–ª–∏—Ü–µ–π `pages` (–ø–æ–ª–µ `collection_config` JSON)
- ‚úÖ Enum `PageType` —Å —Ç–∏–ø–æ–º `Collection`
- ‚úÖ –ë–ª–æ–∫–∏: `main-screen`, `article-cards`, `text-block`, `image-block`
- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
- ‚ùå –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ —Å—Ç–∞—Ç–µ–π/–≥–∞–π–¥–æ–≤
- ‚ùå –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–µ–Ω—è—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∫–∞—Ä—Ç–æ—á–µ–∫
- ‚ùå –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–µ–π –∏ –≥–∞–π–¥–æ–≤ –Ω–∞ —Å–µ–∫—Ü–∏–∏

---

## üéØ –ó–∞–¥–∞—á–∞

–°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É "–í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã" (slug: `all-materials`), –∫–æ—Ç–æ—Ä–∞—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** —Å–æ–±–∏—Ä–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ –≤—Å–µ—Ö –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π –∏ –≥–∞–π–¥–æ–≤.

**–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç —Å—Ç–∞—Ç—å—é ‚Üí –ø—É–±–ª–∏–∫—É–µ—Ç
2. –°—Ç–∞—Ç—å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/all-materials`
3. –†–µ–¥–∞–∫—Ç–æ—Ä –º–æ–∂–µ—Ç –ø–æ–º–µ–Ω—è—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –∫–∞—Ä—Ç–æ—á–∫–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
4. –°—Ç–∞—Ç—å–∏ –∏ –≥–∞–π–¥—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —Å–µ–∫—Ü–∏—è—Ö

---

## üì¶ –®–∞–≥ 1: Domain Layer ‚Äî –ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏

### –§–∞–π–ª: `backend/src/Domain/Entity/Page.php`

**–ß–¢–û –î–ï–õ–ê–¢–¨:** –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `getCardImage()` –≤ –∫–ª–∞—Å—Å `Page`

**–ì–î–ï:** –ü–æ—Å–ª–µ –º–µ—Ç–æ–¥–∞ `getCollectionConfig()` (–ø—Ä–∏–º–µ—Ä–Ω–æ —Å—Ç—Ä–æ–∫–∞ 140-180)

**–ö–û–î –î–õ–Ø –í–°–¢–ê–í–ö–ò:**

```php
    /**
     * –ü–æ–ª—É—á–∏—Ç—å URL –∫–∞—Ä—Ç–∏–Ω–∫–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
     * 
     * –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
     * 1. –ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ –∏–∑ collectionConfig.cardImages
     * 2. –ö–∞—Ä—Ç–∏–Ω–∫–∞ –∏–∑ –±–ª–æ–∫–∞ main-screen
     * 3. –ö–∞—Ä—Ç–∏–Ω–∫–∞ –∏–∑ –±–ª–æ–∫–∞ article-cards
     * 4. –î–µ—Ñ–æ–ª—Ç–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞
     * 
     * @param array|null $blocks –ë–ª–æ–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
     * @return string URL –∫–∞—Ä—Ç–∏–Ω–∫–∏
     */
    public function getCardImage(?array $blocks = null): string
    {
        // 1. –ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ –∏–∑ collectionConfig
        if ($this->collectionConfig && 
            isset($this->collectionConfig['cardImages'][$this->id])) {
            return $this->collectionConfig['cardImages'][$this->id];
        }
        
        // 2-3. –ò–∑–≤–ª–µ—á—å –∏–∑ –±–ª–æ–∫–æ–≤ (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω—ã)
        if ($blocks) {
            foreach ($blocks as $block) {
                $data = $block->getData();
                
                // Main-screen / hero —Å –∫–∞—Ä—Ç–∏–Ω–∫–æ–π
                if (in_array($block->getType(), ['main-screen', 'hero']) && 
                    isset($data['image']['url'])) {
                    return $data['image']['url'];
                }
                
                // Article-cards —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏
                if ($block->getType() === 'article-cards' && 
                    isset($data['cards'][0]['image']['url'])) {
                    return $data['cards'][0]['image']['url'];
                }
            }
        }
        
        // 4. Fallback
        return '/uploads/default-card.jpg';
    }

    /**
     * –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É –¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
     * 
     * @param string $imageUrl URL –∫–∞—Ä—Ç–∏–Ω–∫–∏
     */
    public function setCardImage(string $imageUrl): void
    {
        if (!$this->collectionConfig) {
            $this->collectionConfig = [];
        }
        
        if (!isset($this->collectionConfig['cardImages'])) {
            $this->collectionConfig['cardImages'] = [];
        }
        
        $this->collectionConfig['cardImages'][$this->id] = $imageUrl;
        $this->touch();
    }
```

---

## üì¶ –®–∞–≥ 2: Application Layer ‚Äî Use Case –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏

### –§–∞–π–ª: `backend/src/Application/UseCase/GetCollectionItems.php`

**–ß–¢–û –î–ï–õ–ê–¢–¨:** –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª

**–ö–û–î –§–ê–ô–õ–ê:**

```php
<?php
declare(strict_types=1);

namespace Application\UseCase;

use Domain\Repository\PageRepositoryInterface;
use Domain\Repository\BlockRepositoryInterface;

/**
 * Use Case: –ü–æ–ª—É—á–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ–ª–ª–µ–∫—Ü–∏–∏
 * 
 * –°–æ–±–∏—Ä–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü (—Å—Ç–∞—Ç–µ–π/–≥–∞–π–¥–æ–≤) –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ-–∫–æ–ª–ª–µ–∫—Ü–∏–∏
 */
class GetCollectionItems
{
    private PageRepositoryInterface $pageRepository;
    private BlockRepositoryInterface $blockRepository;
    
    public function __construct(
        PageRepositoryInterface $pageRepository,
        BlockRepositoryInterface $blockRepository
    ) {
        $this->pageRepository = $pageRepository;
        $this->blockRepository = $blockRepository;
    }
    
    /**
     * –í—ã–ø–æ–ª–Ω–∏—Ç—å: –ø–æ–ª—É—á–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ–ª–ª–µ–∫—Ü–∏–∏
     * 
     * @param string $collectionPageId UUID —Å—Ç—Ä–∞–Ω–∏—Ü—ã-–∫–æ–ª–ª–µ–∫—Ü–∏–∏
     * @return array –ú–∞—Å—Å–∏–≤ —Å —Å–µ–∫—Ü–∏—è–º–∏ –∏ –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏
     */
    public function execute(string $collectionPageId): array
    {
        // 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É-–∫–æ–ª–ª–µ–∫—Ü–∏—é
        $collectionPage = $this->pageRepository->findById($collectionPageId);
        
        if (!$collectionPage || !$collectionPage->getType()->isCollection()) {
            throw new \InvalidArgumentException('Page is not a collection');
        }
        
        // 2. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
        $config = $collectionPage->getCollectionConfig() ?? [];
        $sourceTypes = $config['sourceTypes'] ?? ['article', 'guide'];
        $sortBy = $config['sortBy'] ?? 'publishedAt';
        $sortOrder = $config['sortOrder'] ?? 'desc';
        $sections = $config['sections'] ?? null;
        $excludePages = $config['excludePages'] ?? [];
        $cardImages = $config['cardImages'] ?? [];
        
        // 3. –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω—É–∂–Ω—ã—Ö —Ç–∏–ø–æ–≤
        $allPages = [];
        foreach ($sourceTypes as $type) {
            $pages = $this->pageRepository->findByTypeAndStatus($type, 'published');
            $allPages = array_merge($allPages, $pages);
        }
        
        // 4. –ò—Å–∫–ª—é—á–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ excludePages
        $allPages = array_filter($allPages, function($page) use ($excludePages) {
            return !in_array($page->getId(), $excludePages);
        });
        
        // 5. –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        usort($allPages, function($a, $b) use ($sortBy, $sortOrder) {
            $aValue = $this->getPageFieldValue($a, $sortBy);
            $bValue = $this->getPageFieldValue($b, $sortBy);
            
            $comparison = $aValue <=> $bValue;
            return $sortOrder === 'desc' ? -$comparison : $comparison;
        });
        
        // 6. –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏
        $cards = [];
        foreach ($allPages as $page) {
            // –ó–∞–≥—Ä—É–∑–∏—Ç—å –±–ª–æ–∫–∏ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏
            $blocks = $this->blockRepository->findByPageId($page->getId());
            
            $cards[] = [
                'id' => $page->getId(),
                'title' => $page->getTitle(),
                'snippet' => $page->getSeoDescription() ?? '',
                'image' => $page->getCardImage($blocks),
                'url' => '/' . $page->getSlug(),
                'type' => $page->getType()->value,
                'publishedAt' => $page->getPublishedAt()?->format('Y-m-d H:i:s')
            ];
        }
        
        // 7. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Å–µ–∫—Ü–∏—è–º (–µ—Å–ª–∏ –∑–∞–¥–∞–Ω—ã)
        if ($sections) {
            return $this->groupBySections($cards, $sections);
        }
        
        // 8. –í–µ—Ä–Ω—É—Ç—å –æ–¥–Ω—É —Å–µ–∫—Ü–∏—é —Å–æ –≤—Å–µ–º–∏ –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏
        return [
            'sections' => [
                [
                    'title' => '–í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã',
                    'items' => $cards
                ]
            ]
        ];
    }
    
    /**
     * –ü–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
     */
    private function getPageFieldValue($page, string $field)
    {
        switch ($field) {
            case 'publishedAt':
                return $page->getPublishedAt()?->getTimestamp() ?? 0;
            case 'createdAt':
                return $page->getCreatedAt()->getTimestamp();
            case 'updatedAt':
                return $page->getUpdatedAt()?->getTimestamp() ?? 0;
            case 'title':
                return $page->getTitle();
            default:
                return 0;
        }
    }
    
    /**
     * –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ —Å–µ–∫—Ü–∏—è–º
     */
    private function groupBySections(array $cards, array $sections): array
    {
        $result = ['sections' => []];
        
        foreach ($sections as $section) {
            $sectionTitle = $section['title'] ?? '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è';
            $sectionTypes = $section['sourceTypes'] ?? [];
            
            // –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ —Ç–∏–ø–∞–º —Å–µ–∫—Ü–∏–∏
            $sectionCards = array_filter($cards, function($card) use ($sectionTypes) {
                return in_array($card['type'], $sectionTypes);
            });
            
            $result['sections'][] = [
                'title' => $sectionTitle,
                'items' => array_values($sectionCards)
            ];
        }
        
        return $result;
    }
}
```

---

## üì¶ –®–∞–≥ 3: Application Layer ‚Äî Use Case –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏

### –§–∞–π–ª: `backend/src/Application/UseCase/UpdateCollectionCardImage.php`

**–ß–¢–û –î–ï–õ–ê–¢–¨:** –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª

**–ö–û–î –§–ê–ô–õ–ê:**

```php
<?php
declare(strict_types=1);

namespace Application\UseCase;

use Domain\Repository\PageRepositoryInterface;

/**
 * Use Case: –û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
 */
class UpdateCollectionCardImage
{
    private PageRepositoryInterface $pageRepository;
    
    public function __construct(PageRepositoryInterface $pageRepository)
    {
        $this->pageRepository = $pageRepository;
    }
    
    /**
     * –í—ã–ø–æ–ª–Ω–∏—Ç—å: –æ–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –∫–∞—Ä—Ç–æ—á–∫–∏
     * 
     * @param string $collectionPageId UUID —Å—Ç—Ä–∞–Ω–∏—Ü—ã-–∫–æ–ª–ª–µ–∫—Ü–∏–∏
     * @param string $targetPageId UUID —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —á—å—é –∫–∞—Ä—Ç–∏–Ω–∫—É –º–µ–Ω—è–µ–º
     * @param string $imageUrl –ù–æ–≤—ã–π URL –∫–∞—Ä—Ç–∏–Ω–∫–∏
     */
    public function execute(
        string $collectionPageId, 
        string $targetPageId, 
        string $imageUrl
    ): void {
        // 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É-–∫–æ–ª–ª–µ–∫—Ü–∏—é
        $collectionPage = $this->pageRepository->findById($collectionPageId);
        
        if (!$collectionPage || !$collectionPage->getType()->isCollection()) {
            throw new \InvalidArgumentException('Page is not a collection');
        }
        
        // 2. –û–±–Ω–æ–≤–∏—Ç—å collectionConfig.cardImages[targetPageId]
        $config = $collectionPage->getCollectionConfig() ?? [];
        
        if (!isset($config['cardImages'])) {
            $config['cardImages'] = [];
        }
        
        $config['cardImages'][$targetPageId] = $imageUrl;
        
        // 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
        $collectionPage->setCollectionConfig($config);
        $this->pageRepository->update($collectionPage);
    }
}
```

---

## üì¶ –®–∞–≥ 4: Infrastructure Layer ‚Äî –ú–µ—Ç–æ–¥ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤ Repository

### –§–∞–π–ª: `backend/src/Infrastructure/Repository/MySQLPageRepository.php`

**–ß–¢–û –î–ï–õ–ê–¢–¨:** –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `findByTypeAndStatus()` –≤ –∫–ª–∞—Å—Å `MySQLPageRepository`

**–ì–î–ï:** –ü–æ—Å–ª–µ –º–µ—Ç–æ–¥–∞ `findAll()` (–ø—Ä–∏–º–µ—Ä–Ω–æ —Å—Ç—Ä–æ–∫–∞ 300-320)

**–ö–û–î –î–õ–Ø –í–°–¢–ê–í–ö–ò:**

```php
    /**
     * –ù–∞–π—Ç–∏ –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ —Ç–∏–ø—É –∏ —Å—Ç–∞—Ç—É—Å—É
     * 
     * @param string $type –¢–∏–ø —Å—Ç—Ä–∞–Ω–∏—Ü—ã (article, guide, regular, collection)
     * @param string $status –°—Ç–∞—Ç—É—Å —Å—Ç—Ä–∞–Ω–∏—Ü—ã (draft, published, archived)
     * @return array –ú–∞—Å—Å–∏–≤ —Å—Ç—Ä–∞–Ω–∏—Ü
     */
    public function findByTypeAndStatus(string $type, string $status): array
    {
        $stmt = $this->db->prepare('
            SELECT * FROM pages 
            WHERE type = :type 
              AND status = :status
            ORDER BY published_at DESC
        ');
        
        $stmt->execute([
            ':type' => $type,
            ':status' => $status
        ]);
        
        $rows = $stmt->fetchAll(\PDO::FETCH_ASSOC);
        
        return array_map([$this, 'mapRowToPage'], $rows);
    }
```

---

## üì¶ –®–∞–≥ 5: Presentation Layer ‚Äî Controller –¥–ª—è API

### –§–∞–π–ª: `backend/src/Presentation/Controller/CollectionController.php`

**–ß–¢–û –î–ï–õ–ê–¢–¨:** –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª

**–ö–û–î –§–ê–ô–õ–ê:**

```php
<?php
declare(strict_types=1);

namespace Presentation\Controller;

use Application\UseCase\GetCollectionItems;
use Application\UseCase\UpdateCollectionCardImage;
use Infrastructure\Repository\MySQLPageRepository;
use Infrastructure\Repository\MySQLBlockRepository;

/**
 * Controller: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏
 */
class CollectionController
{
    /**
     * GET /api/pages/:id/collection-items
     * 
     * –ü–æ–ª—É—á–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ–ª–ª–µ–∫—Ü–∏–∏ (–∫–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–µ–π/–≥–∞–π–¥–æ–≤)
     */
    public function getItems(string $pageId): void
    {
        try {
            $pageRepo = new MySQLPageRepository();
            $blockRepo = new MySQLBlockRepository();
            
            $useCase = new GetCollectionItems($pageRepo, $blockRepo);
            $result = $useCase->execute($pageId);
            
            header('Content-Type: application/json');
            echo json_encode([
                'success' => true,
                'data' => $result
            ]);
        } catch (\Exception $e) {
            http_response_code(400);
            header('Content-Type: application/json');
            echo json_encode([
                'success' => false,
                'error' => $e->getMessage()
            ]);
        }
    }
    
    /**
     * PATCH /api/pages/:id/card-image
     * 
     * –û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
     */
    public function updateCardImage(string $pageId): void
    {
        try {
            $input = json_decode(file_get_contents('php://input'), true);
            
            if (!isset($input['targetPageId']) || !isset($input['imageUrl'])) {
                throw new \InvalidArgumentException('Missing targetPageId or imageUrl');
            }
            
            $pageRepo = new MySQLPageRepository();
            $useCase = new UpdateCollectionCardImage($pageRepo);
            
            $useCase->execute(
                $pageId,
                $input['targetPageId'],
                $input['imageUrl']
            );
            
            header('Content-Type: application/json');
            echo json_encode([
                'success' => true,
                'message' => 'Card image updated'
            ]);
        } catch (\Exception $e) {
            http_response_code(400);
            header('Content-Type: application/json');
            echo json_encode([
                'success' => false,
                'error' => $e->getMessage()
            ]);
        }
    }
}
```

---

## üì¶ –®–∞–≥ 6: Presentation Layer ‚Äî –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–æ–ª–ª–µ–∫—Ü–∏–∏

### –§–∞–π–ª: `backend/src/Presentation/Controller/PublicPageController.php`

**–ß–¢–û –î–ï–õ–ê–¢–¨ 1:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–∏–ø–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –º–µ—Ç–æ–¥ `renderPage()`

**–ì–î–ï:** –í –Ω–∞—á–∞–ª–µ –º–µ—Ç–æ–¥–∞ `renderPage()` (–ø—Ä–∏–º–µ—Ä–Ω–æ —Å—Ç—Ä–æ–∫–∞ 180-200)

**–ù–ê–ô–¢–ò:**
```php
private function renderPage(\Application\DTO\GetPageWithBlocksResponse $pageData): void
{
    $page = $pageData->page;
    $blocks = $pageData->blocks;
```

**–ó–ê–ú–ï–ù–ò–¢–¨ –ù–ê:**
```php
private function renderPage(\Application\DTO\GetPageWithBlocksResponse $pageData): void
{
    $page = $pageData->page;
    $blocks = $pageData->blocks;
    
    // –ï—Å–ª–∏ —ç—Ç–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
    if ($page['type'] === 'collection') {
        $this->renderCollectionPage($page);
        return;
    }
```

**–ß–¢–û –î–ï–õ–ê–¢–¨ 2:** –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `renderCollectionPage()` –≤ –∫–æ–Ω–µ—Ü –∫–ª–∞—Å—Å–∞

**–ö–û–î –î–õ–Ø –í–°–¢–ê–í–ö–ò:**

```php
    /**
     * –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã-–∫–æ–ª–ª–µ–∫—Ü–∏–∏
     */
    private function renderCollectionPage(array $page): void
    {
        $pageRepo = new \Infrastructure\Repository\MySQLPageRepository();
        $blockRepo = new \Infrastructure\Repository\MySQLBlockRepository();
        
        $useCase = new \Application\UseCase\GetCollectionItems($pageRepo, $blockRepo);
        $collectionData = $useCase->execute($page['id']);
        
        $html = '<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>' . htmlspecialchars($page['seo_title'] ?? $page['title'], ENT_QUOTES, 'UTF-8') . '</title>
    <meta name="description" content="' . htmlspecialchars($page['seo_description'] ?? '', ENT_QUOTES, 'UTF-8') . '">
    <link rel="stylesheet" href="/healthcare-cms-frontend/styles.css">
</head>
<body>
    <header class="main-header">
        <nav>
            <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="/all-materials">–í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</a>
        </nav>
    </header>
    
    <main>
        <div class="container">
            <h1 style="font-family: var(--font-heading); font-size: 2.5rem; margin: 3rem 0 1rem;">
                ' . htmlspecialchars($page['title'], ENT_QUOTES, 'UTF-8') . '
            </h1>
        </div>';
        
        // –†–µ–Ω–¥–µ—Ä–∏—Ç—å —Å–µ–∫—Ü–∏–∏
        foreach ($collectionData['sections'] as $section) {
            $html .= '<section style="padding-top: 3rem; padding-bottom: 3rem;">
                <div class="container">
                    <h3 style="font-family: var(--font-heading); font-size: 1.8rem; margin-bottom: 2rem;">
                        ' . htmlspecialchars($section['title'], ENT_QUOTES, 'UTF-8') . '
                    </h3>
                    <div class="articles-grid">';
            
            // –†–µ–Ω–¥–µ—Ä–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏
            foreach ($section['items'] as $item) {
                $html .= '<div class="article-card">
                    <img src="' . htmlspecialchars($item['image'], ENT_QUOTES, 'UTF-8') . '" 
                         alt="' . htmlspecialchars($item['title'], ENT_QUOTES, 'UTF-8') . '">
                    <div class="article-card-content">
                        <h3>' . htmlspecialchars($item['title'], ENT_QUOTES, 'UTF-8') . '</h3>
                        <p>' . htmlspecialchars($item['snippet'], ENT_QUOTES, 'UTF-8') . '</p>
                        <a href="' . htmlspecialchars($item['url'], ENT_QUOTES, 'UTF-8') . '">–ß–∏—Ç–∞—Ç—å –¥–∞–ª–µ–µ &rarr;</a>
                    </div>
                </div>';
            }
            
            $html .= '</div></div></section>';
        }
        
        $html .= '
    </main>
    
    <footer class="main-footer">
        <p>&copy; 2025 Healthcare Hacks Brazil</p>
    </footer>
</body>
</html>';
        
        echo $html;
        exit;
    }
```

---

## üì¶ –®–∞–≥ 7: –†–æ—É—Ç–∏–Ω–≥ ‚Äî –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è API endpoints

### –§–∞–π–ª: `backend/public/index.php`

**–ß–¢–û –î–ï–õ–ê–¢–¨:** –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –∫–æ–ª–ª–µ–∫—Ü–∏–π

**–ì–î–ï:** –ü–æ—Å–ª–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –¥–ª—è PageController (–ø—Ä–∏–º–µ—Ä–Ω–æ —Å—Ç—Ä–æ–∫–∞ 250-270)

**–ö–û–î –î–õ–Ø –í–°–¢–ê–í–ö–ò:**

```php
// Collection endpoints
if (preg_match('/^\/api\/pages\/([a-f0-9-]{36})\/collection-items$/', $path, $matches)) {
    $controller = new \Presentation\Controller\CollectionController();
    $controller->getItems($matches[1]);
    exit;
}

if (preg_match('/^\/api\/pages\/([a-f0-9-]{36})\/card-image$/', $path, $matches) && 
    $_SERVER['REQUEST_METHOD'] === 'PATCH') {
    $controller = new \Presentation\Controller\CollectionController();
    $controller->updateCardImage($matches[1]);
    exit;
}
```

---

## üì¶ –®–∞–≥ 8: Frontend ‚Äî UI –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ä—Ç–∏–Ω–æ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –§–∞–π–ª: `frontend/editor.js`

**–ß–¢–û –î–ï–õ–ê–¢–¨:** –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏

**–ì–î–ï:** –í –æ–±—ä–µ–∫—Ç Vue.js, –≤ —Å–µ–∫—Ü–∏—é `methods`

**–ö–û–î –î–õ–Ø –í–°–¢–ê–í–ö–ò:**

```javascript
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ–ª–ª–µ–∫—Ü–∏–∏
        async loadCollectionItems() {
            if (this.pageData.type !== 'collection') return;
            
            try {
                const response = await fetch(`/api/pages/${this.pageData.id}/collection-items`);
                const result = await response.json();
                
                if (result.success) {
                    this.collectionItems = result.data;
                }
            } catch (error) {
                console.error('Failed to load collection items:', error);
            }
        },
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –∫–∞—Ä—Ç–æ—á–∫–∏
        async updateCardImage(targetPageId, imageUrl) {
            try {
                const response = await fetch(`/api/pages/${this.pageData.id}/card-image`, {
                    method: 'PATCH',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${this.authToken}`
                    },
                    body: JSON.stringify({
                        targetPageId: targetPageId,
                        imageUrl: imageUrl
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('–ö–∞—Ä—Ç–∏–Ω–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!');
                    await this.loadCollectionItems(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
                } else {
                    alert('–û—à–∏–±–∫–∞: ' + result.error);
                }
            } catch (error) {
                console.error('Failed to update card image:', error);
                alert('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏');
            }
        },
        
        // –ò–∑–º–µ–Ω–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –∫–∞—Ä—Ç–æ—á–∫–∏ (–æ—Ç–∫—Ä—ã—Ç—å –≥–∞–ª–µ—Ä–µ—é)
        async changeCardImage(targetPageId) {
            const newImageUrl = prompt('–í–≤–µ–¥–∏—Ç–µ URL –Ω–æ–≤–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏:');
            if (newImageUrl) {
                await this.updateCardImage(targetPageId, newImageUrl);
            }
        },
```

**–ß–¢–û –î–ï–õ–ê–¢–¨ 2:** –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∫–æ–ª–ª–µ–∫—Ü–∏–π –≤ `mounted()`

**–ù–ê–ô–¢–ò:**
```javascript
    async mounted() {
        await this.loadPage();
    }
```

**–ó–ê–ú–ï–ù–ò–¢–¨ –ù–ê:**
```javascript
    async mounted() {
        await this.loadPage();
        
        // –ï—Å–ª–∏ —ç—Ç–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã
        if (this.pageData.type === 'collection') {
            await this.loadCollectionItems();
        }
    }
```

**–ß–¢–û –î–ï–õ–ê–¢–¨ 3:** –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ –≤ `data()`

**–ù–ê–ô–¢–ò:**
```javascript
    data() {
        return {
            pageData: null,
```

**–î–û–ë–ê–í–ò–¢–¨:**
```javascript
            collectionItems: null,
```

---

## üì¶ –®–∞–≥ 9: Frontend ‚Äî HTML –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –§–∞–π–ª: `frontend/editor.html`

**–ß–¢–û –î–ï–õ–ê–¢–¨:** –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏

**–ì–î–ï:** –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ SEO (–ø—Ä–∏–º–µ—Ä–Ω–æ —Å—Ç—Ä–æ–∫–∞ 400-450)

**–ö–û–î –î–õ–Ø –í–°–¢–ê–í–ö–ò:**

```html
        <!-- Collection Editor -->
        <div v-if="pageData.type === 'collection' && collectionItems" 
             class="collection-editor">
            <h3>–≠–ª–µ–º–µ–Ω—Ç—ã –∫–æ–ª–ª–µ–∫—Ü–∏–∏</h3>
            
            <div v-for="section in collectionItems.sections" :key="section.title">
                <h4>{{ section.title }}</h4>
                
                <div class="collection-cards">
                    <div v-for="item in section.items" :key="item.id" class="collection-card">
                        <img :src="item.image" :alt="item.title" style="width: 100px; height: 100px; object-fit: cover;">
                        <div>
                            <strong>{{ item.title }}</strong>
                            <p>{{ item.snippet }}</p>
                            <button @click="changeCardImage(item.id)">–ò–∑–º–µ–Ω–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
```

---

## üì¶ –®–∞–≥ 10: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã"

### –ß–µ—Ä–µ–∑ API

**–ß–¢–û –î–ï–õ–ê–¢–¨:** –í—ã–ø–æ–ª–Ω–∏—Ç—å POST-–∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã

**–ú–µ—Ç–æ–¥:** `POST /api/pages`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "title": "–í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã",
  "slug": "all-materials",
  "type": "collection",
  "status": "published",
  "seoTitle": "–í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã - Healthcare Hacks Brazil",
  "seoDescription": "–ü–æ–ª–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –≥–∞–π–¥–æ–≤ –∏ —Å—Ç–∞—Ç–µ–π –æ –∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ –ë—Ä–∞–∑–∏–ª–∏–∏",
  "collectionConfig": {
    "sourceTypes": ["article", "guide"],
    "sortBy": "publishedAt",
    "sortOrder": "desc",
    "sections": [
      {
        "title": "–ì–∞–π–¥—ã",
        "sourceTypes": ["guide"]
      },
      {
        "title": "–°—Ç–∞—Ç—å–∏ –∏–∑ –±–ª–æ–≥–∞",
        "sourceTypes": ["article"]
      }
    ],
    "cardImages": {}
  }
}
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Backend (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

- [ ] **–®–∞–≥ 1:** –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `getCardImage()` –≤ `Page.php`
- [ ] **–®–∞–≥ 2:** –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `GetCollectionItems.php`
- [ ] **–®–∞–≥ 3:** –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `UpdateCollectionCardImage.php`
- [ ] **–®–∞–≥ 4:** –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `findByTypeAndStatus()` –≤ `MySQLPageRepository.php`
- [ ] **–®–∞–≥ 5:** –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `CollectionController.php`
- [ ] **–®–∞–≥ 6:** –û–±–Ω–æ–≤–∏—Ç—å `PublicPageController.php` (2 –∏–∑–º–µ–Ω–µ–Ω–∏—è)
- [ ] **–®–∞–≥ 7:** –û–±–Ω–æ–≤–∏—Ç—å —Ä–æ—É—Ç–∏–Ω–≥ –≤ `index.php`
- [ ] **–®–∞–≥ 10:** –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É "–í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã" —á–µ—Ä–µ–∑ API

### Frontend (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

- [ ] **–®–∞–≥ 8:** –û–±–Ω–æ–≤–∏—Ç—å `editor.js` (3 –∏–∑–º–µ–Ω–µ–Ω–∏—è)
- [ ] **–®–∞–≥ 9:** –û–±–Ω–æ–≤–∏—Ç—å `editor.html`

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏

1. –°–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ç—å—é —á–µ—Ä–µ–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä
2. –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å—é
3. –û—Ç–∫—Ä—ã—Ç—å `/all-materials` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
4. ‚úÖ –°—Ç–∞—Ç—å—è –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –≤ —Å–µ–∫—Ü–∏–∏ "–°—Ç–∞—Ç—å–∏ –∏–∑ –±–ª–æ–≥–∞"

### –¢–µ—Å—Ç 2: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤

1. –°–æ–∑–¥–∞—Ç—å 2 –≥–∞–π–¥–∞ (type: guide)
2. –°–æ–∑–¥–∞—Ç—å 2 —Å—Ç–∞—Ç—å–∏ (type: article)
3. –û—Ç–∫—Ä—ã—Ç—å `/all-materials`
4. ‚úÖ –ì–∞–π–¥—ã –≤ —Å–µ–∫—Ü–∏–∏ "–ì–∞–π–¥—ã"
5. ‚úÖ –°—Ç–∞—Ç—å–∏ –≤ —Å–µ–∫—Ü–∏–∏ "–°—Ç–∞—Ç—å–∏ –∏–∑ –±–ª–æ–≥–∞"

### –¢–µ—Å—Ç 3: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ (–µ—Å–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω frontend)

1. –û—Ç–∫—Ä—ã—Ç—å "–í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã" –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
2. –ù–∞–∂–∞—Ç—å "–ò–∑–º–µ–Ω–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É" –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ
3. –í–≤–µ—Å—Ç–∏ –Ω–æ–≤—ã–π URL –∫–∞—Ä—Ç–∏–Ω–∫–∏
4. –û—Ç–∫—Ä—ã—Ç—å `/all-materials` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
5. ‚úÖ –ö–∞—Ä—Ç–∏–Ω–∫–∞ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å

---

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "Page is not a collection"

**–ü—Ä–∏—á–∏–Ω–∞:** –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –∏–º–µ–µ—Ç —Ç–∏–ø `collection`

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ë–î:
```sql
SELECT id, title, type FROM pages WHERE slug = 'all-materials';
```

–¢–∏–ø –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `collection`

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–∞—Ä—Ç–æ—á–∫–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞ 1:** –ù–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π/–≥–∞–π–¥–æ–≤

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
```sql
SELECT id, title, type, status FROM pages WHERE type IN ('article', 'guide');
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–∏—Å–∏ —Å–æ `status = 'published'`

**–ü—Ä–∏—á–∏–Ω–∞ 2:** –ú–µ—Ç–æ–¥ `findByTypeAndStatus()` –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º–µ—Ç–æ–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ `MySQLPageRepository.php`

### –ü—Ä–æ–±–ª–µ–º–∞: "Call to undefined method"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –¥–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `getCardImage()` –≤ –∫–ª–∞—Å—Å `Page`

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –®–∞–≥ 1

---

## üìö –°–ø—Ä–∞–≤–∫–∞ –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ

### –¢–∏–ø—ã —Å—Ç—Ä–∞–Ω–∏—Ü (PageType)

- `regular` ‚Äî –æ–±—ã—á–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- `article` ‚Äî —Å—Ç–∞—Ç—å—è –≤ –±–ª–æ–≥–µ
- `guide` ‚Äî –≥–∞–π–¥ (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è)
- `collection` ‚Äî –∫–æ–ª–ª–µ–∫—Ü–∏—è (–∞–≤—Ç–æ—Å–±–æ—Ä–∫–∞)

### –°—Ç–∞—Ç—É—Å—ã —Å—Ç—Ä–∞–Ω–∏—Ü (PageStatus)

- `draft` ‚Äî —á–µ—Ä–Ω–æ–≤–∏–∫
- `published` ‚Äî –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ
- `archived` ‚Äî –∞—Ä—Ö–∏–≤

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ collectionConfig

```json
{
  "sourceTypes": ["article", "guide"],  // –ö–∞–∫–∏–µ —Ç–∏–ø—ã —Å–æ–±–∏—Ä–∞—Ç—å
  "sortBy": "publishedAt",              // –ü–æ–ª–µ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
  "sortOrder": "desc",                  // –ü–æ—Ä—è–¥–æ–∫ (desc/asc)
  "sections": [                         // –°–µ–∫—Ü–∏–∏ –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
    {
      "title": "–ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–∏",
      "sourceTypes": ["guide"]          // –¢–∏–ø—ã –¥–ª—è —ç—Ç–æ–π —Å–µ–∫—Ü–∏–∏
    }
  ],
  "cardImages": {                       // –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏
    "uuid-—Å—Ç—Ä–∞–Ω–∏—Ü—ã": "/uploads/image.jpg"
  }
}
```

---

## üéØ –ò—Ç–æ–≥

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (MVP):** –®–∞–≥–∏ 1-7, 10 (~4-5 —á–∞—Å–æ–≤)

**–ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –í—Å–µ —à–∞–≥–∏ (~6-8 —á–∞—Å–æ–≤)

**–ì–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏! üöÄ**
