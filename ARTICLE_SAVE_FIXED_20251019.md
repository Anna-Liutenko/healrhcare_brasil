# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—å–∏
**–î–∞—Ç–∞:** 19 –æ–∫—Ç—è–±—Ä—è 2025, 23:49

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "‚úì –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –∑–∞–∫—Ä—ã—Ç—å" –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ —Å—Ç–∞—Ç–µ–π –ø–æ—è–≤–ª—è–ª–∞—Å—å –æ—à–∏–±–∫–∞:
```
Saving error: this.saveToLocalStorage is not a function
```

## –ü—Ä–∏—á–∏–Ω–∞

–ù–∞ XAMPP –±—ã–ª–∞ **—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è `editor.js`**, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–∑—ã–≤–∞–ª–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ `saveToLocalStorage()`.

–≠—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ —É–∂–µ —Ä–µ—à–∞–ª–∞—Å—å **10 –æ–∫—Ç—è–±—Ä—è 2025** (—Å–º. `docs/ARTICLE_EDITOR_SAVE_FIX.md`), –Ω–æ –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è MySQL –∏–∑ backup –º—ã –æ—Ç–∫–∞—Ç–∏–ª–∏—Å—å –Ω–∞ —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é –∫–æ–¥–∞.

## –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `saveArticleAndClose()` –≤ `frontend/editor.js`

**–ë—ã–ª–æ (—Å—Ç—Ä–æ–∫–∞ 598):**
```javascript
async saveArticleAndClose() {
    if (this.quillInstance) {
        try {
            this.articleHtml = this.quillInstance.root.innerHTML;
            this.convertHtmlToBlocks(this.articleHtml);
            
            // ‚ùå –û–®–ò–ë–ö–ê: –º–µ—Ç–æ–¥ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!
            this.saveToLocalStorage();
            
            this.quillInstance = null;
            this.showArticleEditor = false;
            window.history.pushState({}, '', window.location.pathname);
            this.showNotification('‚úÖ –°—Ç–∞—Ç—å—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!', 'success');
        } catch (e) {
            console.error('Saving error:', e);
            this.showNotification('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
        }
    }
},
```

**–°—Ç–∞–ª–æ:**
```javascript
async saveArticleAndClose() {
    if (this.quillInstance) {
        try {
            // –ü–æ–ª—É—á–∞–µ–º HTML –∏–∑ Quill
            this.articleHtml = this.quillInstance.root.innerHTML;

            this.debugMsg('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏', 'info', { htmlLength: this.articleHtml.length });

            // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º HTML –≤ –Ω–∞—à–∏ –±–ª–æ–∫–∏
            this.convertHtmlToBlocks(this.articleHtml);

            // ‚úÖ –ë–ª–æ–∫ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ this.blocks —á–µ—Ä–µ–∑ convertHtmlToBlocks()
            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –Ω–∞–∂–∞—Ç—å "üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ API
            
            this.showNotification('–°—Ç–∞—Ç—å—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –±–ª–æ–∫–∏. –ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É!', 'success');

            // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä
            this.quillInstance = null;
            this.showArticleEditor = false;

            // –ú–µ–Ω—è–µ–º URL –æ–±—Ä–∞—Ç–Ω–æ
            window.history.pushState({}, '', window.location.pathname);

            this.debugMsg('–°—Ç–∞—Ç—å—è —É—Å–ø–µ—à–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±–ª–æ–∫', 'success');
        } catch (e) {
            console.error('Saving error:', e);
            this.debugMsg('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—å–∏', 'error', { error: e.message });
            this.showNotification('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + e.message, 'error');
        }
    }
},
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è –≤ `editor.html` –¥–ª—è cache-busting

**–°—Ç—Ä–æ–∫–∞ 794:**
```html
<!-- –ë—ã–ª–æ -->
<script type="module" src="editor.js?v=1.3"></script>

<!-- –°—Ç–∞–ª–æ -->
<script type="module" src="editor.js?v=1.4.20251019"></script>
```

### 3. –§–∞–π–ª—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ XAMPP

```powershell
robocopy frontend\ C:\xampp\htdocs\visual-editor-standalone\ editor.js editor.html /R:3 /W:1
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ `editor.js` (94.3 KB) - —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω
- ‚úÖ `editor.html` (47.8 KB) - —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ–ø–µ—Ä—å

### Workflow —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—å–∏:

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç —Å—Ç–∞—Ç—å—é –≤ Quill —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ**
   - –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç, –¥–æ–±–∞–≤–ª—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

2. **–ù–∞–∂–∏–º–∞–µ—Ç "‚úì –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –∑–∞–∫—Ä—ã—Ç—å"**
   - HTML –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ Quill: `this.quillInstance.root.innerHTML`
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `convertHtmlToBlocks(html)` - –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç HTML –≤ `text-block`
   - –ë–ª–æ–∫ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ `this.blocks` (Vue reactive array)
   - –†–µ–¥–∞–∫—Ç–æ—Ä –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: **"–°—Ç–∞—Ç—å—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –±–ª–æ–∫–∏. –ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É!"**

3. **–°—Ç–∞—Ç—å—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ preview**
   - –ë–ª–æ–∫ —Ç–∏–ø–∞ `text-block` —Å `containerStyle: 'article'` –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å"** (–≤ —Ç—É–ª–±–∞—Ä–µ)
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `savePage()` ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ API
   - –í—Å–µ –±–ª–æ–∫–∏ (–≤–∫–ª—é—á–∞—è —Å—Ç–∞—Ç—å—é) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

## –ü—Ä–æ–≤–µ—Ä–∫–∞

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä
```
http://localhost/visual-editor-standalone/editor.html#article-editor
```

### 2. –í–æ–π–¥–∏—Ç–µ (anna / TestPass123!)

### 3. –ù–∞–∂–º–∏—Ç–µ "‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å —Å—Ç–∞—Ç—å—é"

### 4. –ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ–∫—Å—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä:
```
Lorem ipsum dolor sit amet
```

### 5. –ù–∞–∂–º–∏—Ç–µ "‚úì –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –∑–∞–∫—Ä—ã—Ç—å"

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –†–µ–¥–∞–∫—Ç–æ—Ä –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- ‚úÖ –ó–µ–ª—ë–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "–°—Ç–∞—Ç—å—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –±–ª–æ–∫–∏. –ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É!"
- ‚úÖ –í preview –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏
- ‚úÖ –í –∫–æ–Ω—Å–æ–ª–∏ (F12): 
  ```
  [DEBUG] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ | INFO | { htmlLength: 123 }
  [DEBUG] –°—Ç–∞—Ç—å—è —É—Å–ø–µ—à–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±–ª–æ–∫ | SUCCESS
  ```

### 6. –ù–∞–∂–º–∏—Ç–µ "üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å" (–≤ –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏)

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ API –∑–∞–ø—Ä–æ—Å: `PUT /api/pages/:id`
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "–°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!"
- ‚úÖ –°—Ç–∞—Ç—å—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

## –í–∞–∂–Ω–æ

‚ö†Ô∏è **–ù–ï –ó–ê–ë–£–î–¨–¢–ï –Ω–∞–∂–∞—Ç—å Ctrl+F5** –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å –æ—á–∏—Å—Ç–∫–æ–π –∫—ç—à–∞!

–ò–ª–∏ –æ—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à —á–µ—Ä–µ–∑ DevTools:
- F12 ‚Üí Network ‚Üí ‚òëÔ∏è Disable cache
- –ò–ª–∏: F12 ‚Üí –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ‚Üí "Empty Cache and Hard Reload"

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `docs/ARTICLE_EDITOR_SAVE_FIX.md` - –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (10 –æ–∫—Ç—è–±—Ä—è 2025)
- `docs/TROUBLESHOOTING_PAGE_SAVE_OCTOBER_2025.md` - –æ–±—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü
- `MYSQL_RESTORED.md` - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ MySQL (–ø—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–∞—Ç–∞)
- `–°–ò–°–¢–ï–ú–ê_–í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ê.md` - –∏—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

## –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. ‚úÖ `frontend/editor.js` (—Å—Ç—Ä–æ–∫–∞ 598-625) - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω `saveArticleAndClose()`
2. ‚úÖ `frontend/editor.html` (—Å—Ç—Ä–æ–∫–∞ 794) - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è `?v=1.4.20251019`
3. ‚úÖ –û–±–∞ —Ñ–∞–π–ª–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ XAMPP

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ —Å Ctrl+F5
